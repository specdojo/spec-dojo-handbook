---
id: product-cstd-as-is # 一意なID
type: domain # screen | api | domain | data | test | flow | rule
title: 商品の概念状態遷移図 (AS-IS)
version: 0.1.0
status: draft # draft | ready | deprecated
owners: []
tags: []

# 参照関係（方向と意味を固定）
depends_on: [] # 技術的・定義的な土台（前提）へのリンク
implements: [] # 満たすべきビジネスルールへのリンク
tests: [] # この仕様を検証するテスト仕様
supersedes: [] # 置き換え関係（古仕様→新仕様）
---

## 概要

現状業務における「商品」の概念的な状態遷移を表します。
状態名・イベント名は「商品ステータス（現状）」をもとに、業務で使われる呼称・行為に合わせて定義しています。

## 概念状態遷移図（CSTD）

```mermaid
stateDiagram-v2
  [*] --> 仕入前

  仕入前       --> 仕入直後     : 納入商品の受入
  仕入直後     --> 検品不合格   : 検品 / 不合格
  仕入直後     --> 販売可能状態 : 検品 / 合格

  検品不合格   --> 仕入前       : 納入先への返品完了

  販売可能状態 --> 購買受付中   : お客様が商品をレジへ持込
  購買受付中   --> 購買済引渡前 : 会計処理完了（支払い済）
  購買受付中   --> 販売可能状態 : 会計中止・キャンセル

  購買済引渡前 --> 販売完了     : 商品引渡し完了
  購買済引渡前 --> 後払い扱い   : 後払い（つけ）として記録

  販売完了     --> [*]
  後払い扱い   --> [*]
```

## 状態の説明

### 仕入前

仕入れ前の段階で、まだ店舗に到着していない商品。

### 仕入直後

店舗に納入された直後の在庫商品。バックヤードで保管され、検品対象となる。

### 検品不合格

検品の結果、不合格となった返品商品。納入元への返品処理が行われる。

### 販売可能状態

検品に合格し、売り場棚に陳列されている販売可能な商品。

### 購買受付中

お客様が商品をレジに持ち込み、会計処理中の会計対象商品。

### 購買済引渡前

会計が完了し代金は支払われたが、まだお客様への引渡しが完了していない商品。

### 販売完了

お客様への引渡しが完了した販売済商品。

### 後払い扱い

会計の結果、代金を「つけ帳」で管理する掛売商品。つけ回収の対象となる。

## 今後の検討メモ

- 検品不合格後のフロー（廃棄か再仕入れか）を、返品プロセスとあわせて詳細化する余地がある。
- 後払い扱いから「つけ回収完了」への状態遷移は、別途「つけ記録」の概念状態遷移図で表現する想定。
