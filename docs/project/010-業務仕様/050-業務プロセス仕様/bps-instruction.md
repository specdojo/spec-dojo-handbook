# BPS 作成の指示テンプレート

- 以下のルールに従って、**業務プロセス仕様（BPS）** を 1 プロセス分作成してください。出力は **Markdown** とします。
- 対象は 1 つの業務プロセス（`bps-xxx-xxxx`）です。システム実装詳細（クラス名・SQL・画面操作手順など）は書かず、**業務レベルの処理**に限定してください。
- 本文構成は、次の見出し（日本語）をこの順序で必ず出力してください：
  > 1. 概要
  > 2. トリガー
  > 3. 前提条件
  > 4. 入力
  > 5. 処理
  > 6. 出力
  > 7. 例外 / 異常系
  > 8. メモ / 将来課題
- 先頭に YAML Frontmatter を付与し、以下の形式で記述してください（不要な項目は省略可だが、`id` / `type` / `title` / `status` は必須）：

  ```yaml
  ---
  id: bps-<英小文字とハイフンで構成したID> # 例: bps-low-stock-detection
  type: domain
  title: <業務プロセス名> # 例: 在庫不足検知
  status: draft # draft / ready / deprecated のいずれか
  version: '1.0.0'
  owners: []
  depends_on: [] # 関連する他プロセスIDやイベントIDなど
  implements: [] # 参照するビジネスルールID(br-xxx-xxxなど)
  tests: [] # 業務受入条件ID(bac-xxx-xxxなど)
  supersedes: []
  ---
  ```

- **トリガー** には、対応する業務イベント ID（`bev-xxx-xxx`）と、その意味・発生タイミングを箇条書きで記述してください。
- **前提条件** では、プロセス開始前に真であるべき業務条件のみを列挙してください（例：「対象商品が販売中状態」など）。
- **入力** は概念レベルの業務データで記述し、業務データ辞書にあるエンティティ・論理名を想定して書いてください。
  - 形式の例（箇条書きで）：
    - エンティティ: 在庫 / 項目: 在庫数・発注点 / 用途: 発注判定の基準
    - エンティティ: 商品 / 項目: 販売状態 / 用途: 発注候補対象商品の絞り込み
  - 物理テーブル名・カラム名・SQL は絶対に書かないでください。
- **処理** は番号付きリストで **5〜9 ステップ程度** にまとめ、各ステップを短い日本語で記述してください。
  - 条件分岐は `if/else` ではなく、自然な日本語条件句（例：「在庫数が発注点を下回る場合は〜」）で表現してください。
  - 複雑なロジックを説明する必要がある場合、任意で TypeScript 風の擬似コードブロックを追加して構いませんが、業務用語ベースの説明を優先してください。
- **出力** では、このプロセスによって生成・更新・削除される概念データ・イベント・通知を列挙してください。
  - イベントには `bev-xxx-xxx` 形式のIDを付けて記述してください（例: `bev-order-candidate-generated`）。
- **例外 / 異常系** では、主要な 2〜4 ケースを挙げ、各ケースについて
  - 何が異常か（例: 「発注点未設定」「外部APIタイムアウト」）
  - どう振る舞うか（例: 「スキップ」「3回リトライ後に失敗記録」「オペレーション通知」）
    を明確に記載してください。
- **メモ / 将来課題** では、既知の改善余地や将来検討事項（例: 「閾値の動的化」「並列処理の最適化」など）を簡潔に書いてください。
- 全体を **業務用語で統一** し、略語を使う場合は、業務用語集に存在する一般的な略語のみとし、意味が推測しづらい略語や内部コードは使用しないでください。
