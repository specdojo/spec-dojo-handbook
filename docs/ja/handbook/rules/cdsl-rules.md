# 概念データストア一覧 （Conceptual Data Stores List）作成ルール

本ドキュメントは、業務分析・要求定義・システム設計のために **概念データストア一覧 （Conceptual Data Stores List）を記述する標準ルール**です。
業務で扱うデータストア（帳簿・台帳・記録など）を一覧で定義します。各データストアの役割・粒度・用途・更新タイミングなどを明確に記載し、データの流れや管理単位を俯瞰できるようにします。

## 0. 概要

概念データストアとは、業務上継続的に保持・参照される情報の集合（帳簿・台帳・記録）を表す。DB やファイル形式などの物理構造ではなく、「業務単位としての情報管理のまとまり」を定義する。

## 1. メタデータ

| 項目       | 説明                                   | 必須 |
| ---------- | -------------------------------------- | ---- |
| id         | 概念データストア一覧ID (cdsl-xxx-xxxx) | ○    |
| type       | `domain` 固定                          | ○    |
| title      | 概念データストア一覧名                 | ○    |
| status     | `draft`/`ready`/`deprecated`           | ○    |
| version    | バージョン                             | 任意 |
| owners     | 担当者                                 | 任意 |
| tags       | タグ・分類                             | 任意 |
| supersedes | 置き換え関係（古仕様→新仕様）          | 任意 |

### 1.1 ID規約

- 概念データストア一覧IDは正規表現 `^cdsl-[a-z0-9-]+$` に合致する一意IDを用いる。
- `type: domain` は業務ドメイン仕様であることを示す。画面やAPI仕様（`screen`/`api`）とは別ドキュメントで管理する。

## 2. 記述ルール

- 仕様間（BDD／SLL／CCD／用語集）で名称の整合性を保つ。

### 2.1 データストア名の命名規則

- **日本語の単数形**を基本とする（例：売上台帳、在庫台帳）
- 略語のみや実装名（SalesTbl など）は禁止
- 「〜台帳」「〜帳簿」「〜一覧表」など、業務慣用名称はそのまま使用してよい

### 2.2 標準列の定義

| 列名               | 説明                                                   |
| ------------------ | ------------------------------------------------------ |
| **データストア名** | 業務での名称。日本語単数形。慣用的名称はそのまま使用可 |
| **対応プロセス**   | 調達／販売／会計など複数可（複数の場合は「、」区切り） |
| **主な内容**       | 記録項目の代表例を名詞句で簡潔に                       |
| **更新タイミング** | 発生イベント・日次・月次などの処理基準                 |
| **粒度**           | データの最小記録単位（例：仕入取引毎／商品×在庫時点）  |
| **主な用途**       | 管理・分析・会計などの目的                             |

※ 列順は **データストア名 → 対応プロセス → 主な内容 → 更新タイミング → 粒度 → 主な用途** の順に統一する。

### 2.3 更新タイミングの標準語彙（改訂）

使用可能なカテゴリ：

- イベント：発注時、納品時、販売時、支払い時
  - 必要に応じて **「イベントA・イベントB時」形式で複数指定可**

- 日次処理：日次（閉店時）
- 月次処理：月次（締め）
- 年次処理：年次（決算）
- 随時：随時、変更時、追加時

### 2.4 物理名の扱い（補足追加）

- 概念データストアでは物理名は **原則記載しない**
- 記載する場合は列名を **`physicalName`** とし、**lowerCamelCase** を用いる

## 3. サンプル

### 3.1 メタデータ（front-matter YAML）

```yaml
---
id: cdsl-main
type: domain
title: 概念データストア一覧(main)
version: 0.1.0
status: draft
owners: []
tags: []
supersedes: []
---
```

### 3.2 概念データストア一覧（表）

| データストア名 | 対応プロセス | 主な内容                                                     | 更新タイミング                       | 粒度           | 主な用途                                     |
| -------------- | ------------ | ------------------------------------------------------------ | ------------------------------------ | -------------- | -------------------------------------------- |
| 商品一覧表     | 調達         | 商品名、仕入単価、販売価格、分類（お菓子／玩具など）         | 随時（新商品追加・価格変更時）       | 商品マスタ単位 | 商品情報の統一、仕入・販売・会計の基礎データ |
| 仕入台帳       | 調達         | 発注日、仕入先、商品名、数量、仕入単価、合計金額、支払状況   | イベント（発注時・納品時）           | 仕入取引毎     | 仕入履歴と支払い管理、原価把握               |
| 在庫台帳       | 調達、販売   | 商品名、入庫数、出庫数、現在庫数、賞味期限                   | イベント（納品時・販売時・補充時）   | 商品×在庫時点  | 欠品防止、再発注判断、廃棄ロス管理           |
| 売上台帳       | 会計         | 日付、販売金額、販売数量、売れ筋商品、販売方法（現金／つけ） | 日次（閉店時）                       | 日次集計       | 売上把握、販売分析、仕入見直し               |
| つけ帳         | 販売、会計   | お客様名、購入日、商品名・金額、支払期日、支払状況           | イベント（購入時・支払い時）         | つけ取引毎     | つけ払い（後払い）の記録と回収管理           |
| レジ記録       | 販売、会計   | 日付、入金（売上）、出金（仕入・経費）、残高                 | 日次（閉店時）／イベント（支払い時） | レジ取引毎     | 現金の入出金管理、レジ締め・差額確認         |
| 支払管理表     | 会計         | 支払先、支払日、金額、支払方法、ステータス                   | イベント（請求書受領時・支払い時）   | 支払取引毎     | 仕入や経費の支払い状況管理                   |
| 会計帳簿       | 会計         | 日次売上、つけ払い入金、経費、仕入原価、利益計算             | 月次（締め）／年次（決算）           | 月次／年次集計 | 会計全体の記録、税務・申告対応用             |

## 4. 生成 AI への指示テンプレート

生成 AI に概念データストア一覧（CDSL）を作らせるときは、以下のような指示を与えます。

> - 以下のルールに従って、**概念データストア一覧（Conceptual Data Stores List: CDSL）** を 1 ファイル作成してください。出力は **Markdown** とします。
> - 対象は「一覧（表）」です。物理DB設計やテーブル設計は書かず、業務としてのデータストア（帳簿・台帳・記録）の整理に集中してください。
> - 禁止: 物理テーブル名・物理カラム名・SQL全文、実装クラス/関数名、APIの内部実装詳細、クリック手順など UI 操作の逐語列挙
> - 先頭に YAML Frontmatter を付与し、以下の形式で記述してください（不要な項目は省略可だが、`id` / `type` / `title` / `status` は必須）：
>
>   ```yaml
>   ---
>   id: cdsl-<英小文字とハイフンで構成したID> # 例: cdsl-main
>   type: domain
>   title: <概念データストア一覧名> # 例: 概念データストア一覧(main)
>   status: draft # draft / ready / deprecated のいずれか
>   version: '1.0.0'
>   owners: []
>   tags: []
>   supersedes: []
>   ---
>   ```
>
> - 本文には、少なくとも次の見出し（日本語）と表を含めてください：
>   > 1. 概念データストア一覧
> - 一覧表は次の列を **この順序** で必ず含めてください：
>   > データストア名 / 対応プロセス / 主な内容 / 更新タイミング / 粒度 / 主な用途
> - 「更新タイミング」は、次の標準語彙から選び、必要なら複数指定してください：
>   > イベント（例: 発注時、納品時、販売時、支払い時） / 日次（閉店時） / 月次（締め） / 随時（変更時、追加時）
> - 「粒度」は、最小記録単位が分かる名詞句で記述してください（例: 仕入取引毎、商品×在庫時点、日次集計）。
> - 物理名は **原則記載しない** でください（どうしても必要な場合のみ、列 `physicalName` を追加し、**lowerCamelCase** を用いる）。
> - 仕様間（BDD／SLL／CCD／用語集）と用語の整合性を保ってください。
> - 全体を **業務用語で統一** し、略語を使う場合は、業務用語集に存在する一般的な略語のみとし、意味が推測しづらい略語や内部コードは使用しないでください。
