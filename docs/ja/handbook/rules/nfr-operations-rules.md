---
id: nfr-operations-rules
title: 非機能要件 / 運用 作成ルール
type: rulebook
status: draft
---

Non-Functional Requirements Operations Documentation Rules

本ドキュメントは、非機能要件のうち運用（監視、バックアップ、手順、体制）を定義する `nfr-operations` の作成ルールを定義する。
運用要件は、平常時監視と異常時対応が継続可能であることを基準化する。

## 1. 全体方針

- 運用は監視可能性、通知、手動介入条件、復旧性を要求として定義する。
- 運用手順そのものではなく、満たすべき運用結果を記述する。
- OPR/OPD と接続して実行可能性を担保する。

## 2. 位置づけと用語定義（必要に応じて）

### 2.1. 位置づけ

- `nfr-operations`：運用要求の正本
- `nfr-index`：NFR全体の入口
- `opd-*` / `opr-*`：運用方針・運用手順
- `sac-*`：運用要件の受入判定

### 2.2. 用語定義

| 用語         | 定義                                         |
| ------------ | -------------------------------------------- |
| 運用性       | 監視・保守・障害対応を継続的に実行できる性質 |
| MTTD         | 平均検知時間                                 |
| 手動介入条件 | 自動処理から運用判断へ切り替える条件         |

## 3. ファイル命名・ID規則

- ルールドキュメントIDは `nfr-operations-rules`。
- 生成対象ドキュメントIDは `nfr-operations` を推奨する。
- 要件IDは `nfr-ops-<連番>` を推奨する。

## 4. 推奨 Frontmatter 項目

### 4.1. 設定内容

Frontmatter は共通スキーマに従います（参照: [shared/schemas/spec-frontmatter.schema.yaml](../../../../shared/schemas/spec-frontmatter.schema.yaml) / [meta-document-metadata-rules.md](meta-document-metadata-rules.md)）。

| 項目    | 説明                                | 必須 |
| ------- | ----------------------------------- | ---- |
| id      | `nfr-operations`                    | ○    |
| type    | `architecture` など共通スキーマ準拠 | ○    |
| title   | 非機能要件: 運用                    | ○    |
| status  | `draft` / `ready` / `deprecated`    | ○    |
| part_of | `nfr-index`                         | 任意 |

### 4.2. 推奨ルール

- OPRに手順がある要件は、NFRでは達成基準のみを書く。

## 5. 本文構成（標準テンプレ）

`nfr-operations` は以下の見出し構成を **順序固定** で配置する。

| 番号 | 見出し               | 必須 |
| ---- | -------------------- | ---- |
| 1    | 概要（対象・目的）   | ○    |
| 2    | 適用範囲・体制前提   | ○    |
| 3    | 運用要件一覧         | ○    |
| 4    | 測定・検証方法       | ○    |
| 5    | 関連ドキュメント導線 | ○    |

## 6. 記述ガイド

### 6.1. 概要（対象・目的）

生成する本文の見出しは **## 1. 概要（対象・目的）**

- 監視・運用の目的と対象を示す。

### 6.2. 適用範囲・体制前提

生成する本文の見出しは **## 2. 適用範囲・体制前提**

- 監視時間、オンコール体制、通知経路を明記する。

### 6.3. 運用要件一覧

生成する本文の見出しは **## 3. 運用要件一覧**

- 表形式（`id` / `内容` / `指標` / `基準` / `備考`）で記述する。
- 指標例：MTTD、アラート誤検知率、バックアップ成功率。

### 6.4. 測定・検証方法

生成する本文の見出しは **## 4. 測定・検証方法**

- 監視ダッシュボード、運用レポート、訓練結果で判定する。

### 6.5. 関連ドキュメント導線

生成する本文の見出しは **## 5. 関連ドキュメント導線**

- `opd-*`、`opr-*`、`sac-*`、`adr-*` への導線を記載する。

## 7. 禁止事項

| 禁止事項                     | 理由                       |
| ---------------------------- | -------------------------- |
| 手順書の全文を再掲する       | 文書責務が混在するため     |
| 通知先や判定条件を曖昧にする | 運用不能になるため         |
| 監視指標を定義しない         | 品質評価が継続できないため |

## 8. サンプル

注：以下はルール文書内の例示です。生成する `nfr-operations` では `## 1...` から始まります。

```yaml
---
id: nfr-operations
type: architecture
title: 非機能要件: 運用
status: draft
part_of: [nfr-index]
based_on: []
supersedes: []
---
```

### 8.1. 概要（対象・目的）（例）

本書は、GCS 基幹システムにおいて運用（監視・バックアップ・手順・体制）に関する
非機能要件を定義する。
平常時の監視と異常時の対応が継続的に実行可能であることを基準化し、
運用品質の維持・改善を目的とする。

### 8.2. 適用範囲・体制前提（例）

| 項目           | 内容                                             |
| -------------- | ------------------------------------------------ |
| 対象システム   | GCS 基幹システム（受注・在庫・会計サブシステム） |
| 監視時間       | 24 時間 365 日                                   |
| オンコール体制 | SRE 2 名（交代）・営業時間外はアラート待機       |
| 通知経路       | PagerDuty → Slack → 電話エスカレーション         |
| 監視基盤       | Datadog（APM / Logs / Metrics）                  |

### 8.3. 運用要件一覧（例）

| id          | 内容                                               | 指標           | 基準            | 備考                           |
| ----------- | -------------------------------------------------- | -------------- | --------------- | ------------------------------ |
| nfr-ops-001 | 重大障害は基準時間内に検知する                     | MTTD           | 10 分以内       | 24/365                         |
| nfr-ops-002 | 日次バックアップは成功を維持する                   | 成功率         | 99.5% 以上      | 失敗時は自動再試行             |
| nfr-ops-003 | アラート誤検知率を基準以下に保つ                   | 誤検知率       | 10% 以下        | アラート疲労防止               |
| nfr-ops-004 | P1 障害の通知が基準時間内に届くこと                | 通知到達時間   | 5 分以内        | PagerDuty → Slack              |
| nfr-ops-005 | Runbook は全重要サービスに対して整備されていること | Runbook 網羅率 | 100%            | 重要サービス＝受注・在庫・会計 |
| nfr-ops-006 | 障害訓練を定期的に実施すること                     | 訓練実施頻度   | 四半期 1 回以上 | GameDay 形式                   |
| nfr-ops-007 | デプロイは自動化され、手動介入なく完了すること     | 自動デプロイ率 | 100%            | カナリア + 自動ロールバック    |
| nfr-ops-008 | ログ保持期間は基準以上を維持すること               | ログ保持期間   | 90 日以上       | アーカイブ: 1 年               |

### 8.4. 測定・検証方法（例）

| 要件ID      | 測定方法                                           | 判定タイミング   | 判定者       |
| ----------- | -------------------------------------------------- | ---------------- | ------------ |
| nfr-ops-001 | 監視アラート発報から検知までの時間を計測           | 障害事後レビュー | SRE          |
| nfr-ops-002 | バックアップジョブ監視ダッシュボードで成功率を集計 | 日次確認         | Ops          |
| nfr-ops-003 | アラート履歴から誤検知率を集計                     | 月次運用レビュー | SRE          |
| nfr-ops-004 | PagerDuty の通知到達ログから確認                   | 障害事後レビュー | SRE          |
| nfr-ops-005 | Runbook 一覧とサービス一覧の突合                   | 四半期レビュー   | SRE / PM     |
| nfr-ops-006 | 障害訓練実施記録と振り返りレポート                 | 四半期実施確認   | SRE / PM     |
| nfr-ops-007 | CI/CD パイプラインの手動ステップ有無を確認         | 四半期レビュー   | テックリード |
| nfr-ops-008 | ログ保持ポリシーと実際の保持日数を確認             | 四半期監査       | SRE / DBA    |

### 8.5. 関連ドキュメント導線（例）

| 種別     | ドキュメントID | 目的                            | 備考 |
| -------- | -------------- | ------------------------------- | ---- |
| NFR 入口 | nfr-index      | 非機能要件全体の俯瞰            | 必須 |
| 受入条件 | sac-\*         | 運用要件の合否判定基準          | 必須 |
| 運用設計 | opd-\*         | 監視設計・アラート設計          | 必須 |
| 運用手順 | opr-\*         | Runbook・障害対応・バックアップ | 必須 |
| 判断記録 | adr-\*         | 運用に関する設計判断の追跡      | 任意 |

## 9. 生成 AI への指示テンプレート

生成 AI に `nfr-operations` を作成させるときの指示テンプレートは [`nfr-operations-instruction.md`](../instructions/nfr-operations-instruction.md) を参照してください。
