---
id: nfr-security-safety-rules
title: 非機能要件 / 機密性・安全性 作成ルール
type: rulebook
status: draft
---

Non-Functional Requirements Security and Safety Documentation Rules

本ドキュメントは、非機能要件のうち機密性・安全性（認証、認可、保護、監査）を定義する `nfr-security-safety` の作成ルールを定義する。
機密性・安全性要件は、権限逸脱や情報漏えいを防ぐ基準を定量化する。

## 1. 全体方針

- 機密性・安全性はアクセス制御、情報保護、監査可能性で定義する。
- 要件は「許可されない操作が実行されない」ことを基準化する。
- 脅威・規制要件に対する検証可能な制約として記述する。

## 2. 位置づけと用語定義（必要に応じて）

### 2.1. 位置づけ

- `nfr-security-safety`：機密性・安全性要求の正本
- `nfr-index`：NFR全体の入口
- `sac-*` / `sts-*`：受入・試験仕様
- `opd-*` / `opr-*`：監視・インシデント対応

### 2.2. 用語定義

| 用語     | 定義                                       |
| -------- | ------------------------------------------ |
| 機密性   | 許可された主体のみ情報へアクセスできる性質 |
| 安全性   | 不正操作や有害事象を抑制する性質           |
| 認可逸脱 | 権限外の操作が許可されること               |

## 3. ファイル命名・ID規則

- ルールドキュメントIDは `nfr-security-safety-rules`。
- 生成対象ドキュメントIDは `nfr-security-safety` を推奨する。
- 要件IDは `nfr-sec-<連番>` を推奨する。

## 4. 推奨 Frontmatter 項目

### 4.1. 設定内容

Frontmatter は共通スキーマに従います（参照: [shared/schemas/spec-frontmatter.schema.yaml](../../../../shared/schemas/spec-frontmatter.schema.yaml) / [meta-document-metadata-rules.md](meta-document-metadata-rules.md)）。

| 項目    | 説明                                | 必須 |
| ------- | ----------------------------------- | ---- |
| id      | `nfr-security-safety`               | ○    |
| type    | `architecture` など共通スキーマ準拠 | ○    |
| title   | 非機能要件: 機密性・安全性          | ○    |
| status  | `draft` / `ready` / `deprecated`    | ○    |
| part_of | `nfr-index`                         | 任意 |

### 4.2. 推奨ルール

- 規制・監査基準への適合要件がある場合は `based_on` に明示する。

## 5. 本文構成（標準テンプレ）

`nfr-security-safety` は以下の見出し構成を **順序固定** で配置する。

| 番号 | 見出し                 | 必須 |
| ---- | ---------------------- | ---- |
| 1    | 概要（対象・目的）     | ○    |
| 2    | 適用範囲・脅威前提     | ○    |
| 3    | 機密性・安全性要件一覧 | ○    |
| 4    | 測定・検証方法         | ○    |
| 5    | 関連ドキュメント導線   | ○    |

## 6. 記述ガイド

### 6.1. 概要（対象・目的）

生成する本文の見出しは **## 1. 概要（対象・目的）**

- 保護対象（情報・操作）と守るべき目的を示す。

### 6.2. 適用範囲・脅威前提

生成する本文の見出しは **## 2. 適用範囲・脅威前提**

- 想定脅威、対象境界、対象外を明記する。

### 6.3. 機密性・安全性要件一覧

生成する本文の見出しは **## 3. 機密性・安全性要件一覧**

- 表形式（`id` / `内容` / `指標` / `基準` / `備考`）で記述する。
- 指標例：認可逸脱件数、脆弱性修正SLA、監査ログ欠落率。

### 6.4. 測定・検証方法

生成する本文の見出しは **## 4. 測定・検証方法**

- セキュリティ試験、監査ログ検証、脆弱性スキャンで判定する。

### 6.5. 関連ドキュメント導線

生成する本文の見出しは **## 5. 関連ドキュメント導線**

- `opd-*`、`opr-*`、`sac-*`、`adr-*`、セキュリティ方針文書への導線を置く。

## 7. 禁止事項

| 禁止事項                             | 理由                     |
| ------------------------------------ | ------------------------ |
| 「安全にする」だけで基準がない       | 検証不能のため           |
| 認可・監査の要件を分離せず曖昧化する | 事故原因追跡が困難なため |
| 例外運用を本文に散在させる           | 統制不能になるため       |

## 8. サンプル

注：以下はルール文書内の例示です。生成する `nfr-security-safety` では `## 1...` から始まります。

```yaml
---
id: nfr-security-safety
type: architecture
title: 非機能要件: 機密性・安全性
status: draft
part_of: [nfr-index]
based_on: []
supersedes: []
---
```

### 8.1. 概要（対象・目的）（例）

本書は、GCS 基幹システムにおいて機密性・安全性（認証・認可・情報保護・監査）に
関する非機能要件を定義する。
権限逸脱や情報漏えいを防ぎ、規制・監査要件への適合を検証可能な
制約として管理することを目的とする。

### 8.2. 適用範囲・脅威前提（例）

| 項目         | 内容                                                |
| ------------ | --------------------------------------------------- |
| 対象システム | GCS 基幹システム（Web UI・API・バッチ・データ基盤） |
| 想定脅威     | 不正ログイン、権限昇格、インジェクション、CSRF      |
| 規制要件     | 個人情報保護法、社内セキュリティポリシー            |
| 対象外       | 物理セキュリティ、ネットワークインフラ（別文書）    |
| 脆弱性管理   | CVSS 7.0 以上を「重大」と分類                       |

### 8.3. 機密性・安全性要件一覧（例）

| id          | 内容                                               | 指標                 | 基準        | 備考                     |
| ----------- | -------------------------------------------------- | -------------------- | ----------- | ------------------------ |
| nfr-sec-001 | 権限外ユーザーは機密データを参照できないこと       | 認可逸脱件数         | 0 件/四半期 | STS で検証               |
| nfr-sec-002 | 重大脆弱性は期限内に修正する                       | 修正 SLA 達成率      | 95% 以上    | CVSS 7.0 以上対象        |
| nfr-sec-003 | 認証は多要素認証を必須とする                       | MFA 適用率           | 100%        | 管理者・一般ユーザー共通 |
| nfr-sec-004 | セッションタイムアウトを基準内に設定する           | アイドルタイムアウト | 30 分       | トークンベース           |
| nfr-sec-005 | 監査ログは改ざん不能で保管すること                 | ログ改ざん検知率     | 100%        | WORM ストレージ採用      |
| nfr-sec-006 | API 入力は全エンドポイントでバリデーションすること | バリデーション網羅率 | 100%        | OpenAPI スキーマ検証必須 |
| nfr-sec-007 | 機密データは保管時・転送時に暗号化すること         | 暗号化適用率         | 100%        | AES-256 / TLS 1.2 以上   |

### 8.4. 測定・検証方法（例）

| 要件ID      | 測定方法                                         | 判定タイミング      | 判定者       |
| ----------- | ------------------------------------------------ | ------------------- | ------------ |
| nfr-sec-001 | ペネトレーションテスト（権限かいくぐりシナリオ） | リリース前 / 四半期 | セキュリティ |
| nfr-sec-002 | 脆弱性管理ツールの修正完了データ                 | 月次集計            | セキュリティ |
| nfr-sec-003 | 認証プロバイダの MFA 設定状況確認                | 四半期監査          | SRE          |
| nfr-sec-004 | トークン有効期限の設定値をレビュー               | リリース前レビュー  | QA / SRE     |
| nfr-sec-005 | WORM ストレージの書き込み禁止確認テスト          | 四半期監査          | DBA / SRE    |
| nfr-sec-006 | OpenAPI スキーマ検証テストを CI で実行           | merge 毎            | QA           |
| nfr-sec-007 | TLS バージョン・暗号化設定のスキャン             | 四半期スキャン      | Infra / SRE  |

### 8.5. 関連ドキュメント導線（例）

| 種別             | ドキュメントID   | 目的                        | 備考 |
| ---------------- | ---------------- | --------------------------- | ---- |
| NFR 入口         | nfr-index        | 非機能要件全体の俯瞰        | 必須 |
| 受入条件         | sac-\*           | セキュリティ要件の合否判定  | 必須 |
| システム試験     | sts-\*           | セキュリティ観点の E2E 試験 | 必須 |
| 運用設計         | opd-\*           | 監視・インシデント対応基準  | 必須 |
| 運用手順         | opr-\*           | インシデント一次対応手順    | 必須 |
| 判断記録         | adr-\*           | セキュリティ設計判断の追跡  | 任意 |
| セキュリティ方針 | （社内ポリシー） | 規制・社内基準との整合確認  | 任意 |

## 9. 生成 AI への指示テンプレート

生成 AI に `nfr-security-safety` を作成させるときの指示テンプレートは [`nfr-security-safety-instruction.md`](../instructions/nfr-security-safety-instruction.md) を参照してください。
