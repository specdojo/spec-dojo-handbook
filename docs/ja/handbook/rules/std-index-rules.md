# 総合テスト設計（STD）作成ルール

本ドキュメントは、
**総合テスト仕様（STS / STS-D）で定義された「何を保証するか」を、
実際にどのような切り口・構成でテストとして実現するか**
を定義するための標準ルールです。

STD は、

- テスト仕様を **テスト構造・実施単位に落とす設計書**
- 個別テストケースを書く前段階の **設計レベルの合意文書**

として位置づけます。

---

## 0. 位置づけ（必読）

```plaintext
TSP（テスト戦略・方針）
 └ STS（総合テスト仕様）
    └ STS-D（総合テスト仕様・個別）
       └ STD（総合テスト設計）        ← 本書
          └ STD-D（総合テスト設計・個別）
             └ テスト実行・結果
```

| 観点   | STS            | STD                    |
| ------ | -------------- | ---------------------- |
| 主眼   | 何を保証するか | どう構成して確認するか |
| 粒度   | 仕様           | 設計                   |
| 単位   | 業務・シナリオ | テスト構成・観点分解   |
| ケース | 書かない       | **まだ書かない**       |

---

## 1. 全体方針

- STD は **総合テスト全体の設計方針**を定義します。
- STS / STS-D を **網羅的・効率的にテスト可能な構成**に分解します。
- STD では次を明確にします：
  - テストの分割単位（観点軸・構成軸）
  - テスト実施の流れ・構成
  - 個別設計（STD-D）への分解方針

- 入力値・期待値・具体ケースは **STD-D に委譲**します。

---

## 2. 対象範囲

STD の対象は以下です。

- 総合テスト（System Test）全体
- 業務シナリオ／業務フロー／非機能確認を含む
- 単体・結合テストは対象外（前提条件として扱う）

---

## 3. ファイル命名・ID規則

### ファイル名（推奨）

```sh
010-総合テスト設計.md
```

### ID ルール

| 項目   | ルール                     |
| ------ | -------------------------- |
| prefix | `std-`                     |
| id     | `std-main`, `std-overview` |

※ 全体設計は原則 **1ファイル**

---

## 4. 推奨 Frontmatter 項目

| 項目       | 説明                         | 必須     |
| ---------- | ---------------------------- | -------- |
| id         | STD ID（`std-*`）            | ○        |
| type       | `test` 固定                  | ○        |
| title      | 総合テスト設計               | ○        |
| status     | `draft / ready / deprecated` | ○        |
| based_on   | `tsp-*`, `sts-main`, `sts-*` | **必須** |
| supersedes | 置換関係                     | 任意     |

---

## 5. 本文構成（標準テンプレ）

STD は以下の見出しを **必ずこの順序**で記述します。

1. 概要
2. 設計方針
3. テスト構成と分割単位
4. テスト観点の整理
5. テスト実施構成
6. 個別設計（STD-D）への分解方針
7. 対象外・前提
8. メモ / 将来課題

---

## 6. 記述ガイド詳細

### 6.1 概要

- 総合テスト設計の目的と位置づけを 1〜2 文で記述します。

例：

> 本設計は、総合テスト仕様で定義された業務・非機能要件を、実施可能なテスト構成へ落とし込むことを目的とする。

---

### 6.2 設計方針（必須）

- テスト全体をどう組み立てるかの **考え方** を示します。

例：

- 業務シナリオを主軸にテストを構成する
- 非機能は業務シナリオと独立して横断的に確認する
- 重要業務は正常系＋代表的な例外のみを総合テストで扱う

---

### 6.3 テスト構成と分割単位（必須）

「何単位でテストを分けるか」を明示します。

例：

| 分割軸   | 単位例                 |
| -------- | ---------------------- |
| 業務     | 受注、出荷、請求       |
| シナリオ | 通常、在庫不足、再処理 |
| 観点     | 正常系、例外系、非機能 |

※ この表が **STD-D 作成の地図**になります。

---

### 6.4 テスト観点の整理（必須）

STS で定義された観点を、設計として整理します。

| 観点カテゴリ | 説明                         |
| ------------ | ---------------------------- |
| 業務         | フロー成立、業務結果の正当性 |
| データ       | 整合性、更新タイミング       |
| 連携         | 外部IFの連携結果             |
| 非機能       | 性能、監査、可観測性         |
| 運用         | 再実行性、エラーハンドリング |

※ **観点の網羅性をここで担保**

---

### 6.5 テスト実施構成（必須）

- 実施順序や構成上の前提を整理します。

例：

- 業務シナリオ単位で独立して実施可能とする
- 非機能確認は業務シナリオ完了後に実施
- 再実行可能な構成とする

---

### 6.6 個別設計（STD-D）への分解方針（必須）

- どの単位で STD-D を作るかを明示します。

例：

- 業務シナリオ単位で 1 STD-D
- 非機能は業務横断で 1 STD-D

---

### 6.7 対象外・前提

- 総合テスト設計の前提条件
- 単体・結合テストで保証済みとみなす事項

---

### 6.8 メモ / 将来課題

- 将来追加予定のシナリオ
- 未確定事項

---

## 7. 禁止事項

| 禁止事項               | 理由             |
| ---------------------- | ---------------- |
| テストケースの記載     | STD-D の責務     |
| 入力値・期待値の具体化 | 設計レベルを逸脱 |
| UI操作の逐語列挙       | UI変更に弱い     |
| 実装依存情報           | 再利用性低下     |

---

## 8. サンプル（最小）

```yaml
---
id: std-main
type: test
title: 総合テスト設計
status: draft
based_on:
  - tsp-overview
  - sts-main
---
```

---

## 9. 生成AI向け指示テンプレート

> - 以下のルールに従って **総合テスト設計（STD）** を 1 ファイル作成してください。
> - 総合テスト仕様（STS / STS-D）を前提に、テスト構成・分割単位・観点整理を行ってください。
> - ケース・入力値・期待値は記載せず、設計方針と構造を記述してください。
> - 実装依存情報、UI操作の逐語列挙は禁止です。
