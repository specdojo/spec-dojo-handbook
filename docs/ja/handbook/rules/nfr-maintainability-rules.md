---
id: nfr-maintainability-rules
title: 非機能要件 / 保守性 作成ルール
type: rulebook
status: draft
---

Non-Functional Requirements Maintainability Documentation Rules

本ドキュメントは、非機能要件のうち保守性（変更容易性・障害解析容易性）を定義する `nfr-maintainability` の作成ルールを定義する。
保守性要件は、修正・調査・復旧を継続的に行える運用品質を定量化する。

## 1. 全体方針

- 保守性は変更コストと復旧コストを下げる要求として定義する。
- MTTR、変更リードタイム、診断可能性などの指標を用いる。
- 実装方法ではなく、達成すべき運用可能性を記述する。

## 2. 位置づけと用語定義（必要に応じて）

### 2.1. 位置づけ

- `nfr-maintainability`：保守性要求の正本
- `nfr-index`：NFR全体の入口
- `opd-*` / `opr-*`：運用と変更手順
- `sac-*`：受入時の判定基準

### 2.2. 用語定義

| 用語             | 定義                                     |
| ---------------- | ---------------------------------------- |
| 保守性           | 修正・改修・障害対応を効率よく行える性質 |
| MTTR             | 平均復旧時間                             |
| 変更リードタイム | 要求受領から本番反映までの時間           |

## 3. ファイル命名・ID規則

- ルールドキュメントIDは `nfr-maintainability-rules`。
- 生成対象ドキュメントIDは `nfr-maintainability` を推奨する。
- 要件IDは `nfr-mnt-<連番>` を推奨する。

## 4. 推奨 Frontmatter 項目

### 4.1. 設定内容

Frontmatter は共通スキーマに従います（参照: [shared/schemas/spec-frontmatter.schema.yaml](../../../../shared/schemas/spec-frontmatter.schema.yaml) / [meta-document-metadata-rules.md](meta-document-metadata-rules.md)）。

| 項目    | 説明                                | 必須 |
| ------- | ----------------------------------- | ---- |
| id      | `nfr-maintainability`               | ○    |
| type    | `architecture` など共通スキーマ準拠 | ○    |
| title   | 非機能要件: 保守性                  | ○    |
| status  | `draft` / `ready` / `deprecated`    | ○    |
| part_of | `nfr-index`                         | 任意 |

### 4.2. 推奨ルール

- 調査ログ、監視、Runbook の整備水準を `based_on` と整合させる。

## 5. 本文構成（標準テンプレ）

`nfr-maintainability` は以下の見出し構成を **順序固定** で配置する。

| 番号 | 見出し               | 必須 |
| ---- | -------------------- | ---- |
| 1    | 概要（対象・目的）   | ○    |
| 2    | 適用範囲・前提条件   | ○    |
| 3    | 保守性要件一覧       | ○    |
| 4    | 測定・検証方法       | ○    |
| 5    | 関連ドキュメント導線 | ○    |

## 6. 記述ガイド

### 6.1. 概要（対象・目的）

生成する本文の見出しは **## 1. 概要（対象・目的）**

- どの変更・障害対応の効率を担保するかを示す。

### 6.2. 適用範囲・前提条件

生成する本文の見出しは **## 2. 適用範囲・前提条件**

- 対象システム、対象運用時間、チーム体制前提を記述する。

### 6.3. 保守性要件一覧

生成する本文の見出しは **## 3. 保守性要件一覧**

- 表形式（`id` / `内容` / `指標` / `基準` / `備考`）で記述する。
- 指標例：MTTR、変更リードタイム、一次切り分け時間。

### 6.4. 測定・検証方法

生成する本文の見出しは **## 4. 測定・検証方法**

- 監視記録、障害レポート、改善サイクルで測定する。

### 6.5. 関連ドキュメント導線

生成する本文の見出しは **## 5. 関連ドキュメント導線**

- `opd-*`、`opr-*`、`adr-*` への導線を必ず置く。

## 7. 禁止事項

| 禁止事項                             | 理由                 |
| ------------------------------------ | -------------------- |
| 「保守しやすい」だけで閾値を示さない | 判定不能のため       |
| 体制依存の一時運用を恒久要件化する   | 再現性がないため     |
| 測定データの取得方法を書かない       | 継続評価できないため |

## 8. サンプル

注：以下はルール文書内の例示です。生成する `nfr-maintainability` では `## 1...` から始まります。

```yaml
---
id: nfr-maintainability
type: architecture
title: 非機能要件: 保守性
status: draft
part_of: [nfr-index]
based_on: []
supersedes: []
---
```

### 8.1. 概要（対象・目的）（例）

本書は、GCS 基幹システムにおいて保守性（変更容易性・障害解析容易性）に関する
非機能要件を定義する。
障害対応の迅速化と変更リードタイムの短縮を測定可能な基準で管理し、
システムの運用品質を継続的に改善することを目的とする。

### 8.2. 適用範囲・前提条件（例）

| 項目         | 内容                                              |
| ------------ | ------------------------------------------------- |
| 対象システム | GCS 基幹システム（受注・在庫・会計サブシステム）  |
| 運用時間     | 24/365（オンコール体制あり）                      |
| チーム体制   | 開発 5 名・SRE 2 名・Ops 3 名（平日日勤）         |
| ログ基盤     | 構造化ログ（JSON）・分散トレーシング導入済        |
| CI/CD        | GitHub Actions + ArgoCD（トランクベースデプロイ） |

### 8.3. 保守性要件一覧（例）

| id          | 内容                                                 | 指標             | 基準         | 備考                         |
| ----------- | ---------------------------------------------------- | ---------------- | ------------ | ---------------------------- |
| nfr-mnt-001 | P1 障害は基準時間内に一次復旧する                    | MTTR             | 60 分以内    | 24/365 対象                  |
| nfr-mnt-002 | 軽微変更は短期間で本番反映する                       | 変更リードタイム | 3 営業日以内 | 標準変更のみ                 |
| nfr-mnt-003 | 障害の一次切り分けを基準時間内に完了する             | 一次切り分け時間 | 15 分以内    | Runbook + 監視ダッシュボード |
| nfr-mnt-004 | デプロイのロールバックを基準時間内に完了する         | ロールバック時間 | 15 分以内    | トランクベース切り戻し       |
| nfr-mnt-005 | テストカバレッジを基準以上に維持する                 | カバレッジ率     | 80% 以上     | ビジネスロジック対象         |
| nfr-mnt-006 | 障害原因調査に必要なログが従事者だけで追跡できること | 調査自己完結率   | 90% 以上     | trace_id で横断検索          |
| nfr-mnt-007 | API スキーマ変更は後方互換で行えること               | 互換性維持期間   | 6 か月以上   | OpenAPI バージョニング       |

### 8.4. 測定・検証方法（例）

| 要件ID      | 測定方法                                        | 判定タイミング   | 判定者       |
| ----------- | ----------------------------------------------- | ---------------- | ------------ |
| nfr-mnt-001 | インシデント記録から検知〜復旧までの時間を算出  | 障害事後レビュー | SRE / PM     |
| nfr-mnt-002 | PR マージ〜本番デプロイまでのリードタイムを計測 | 月次集計         | テックリード |
| nfr-mnt-003 | 障害レポートの切り分け完了時刻から算出          | 障害事後レビュー | SRE          |
| nfr-mnt-004 | ロールバック訓練で切り戻し時間を計測            | 四半期訓練       | Infra / SRE  |
| nfr-mnt-005 | CI カバレッジレポートで確認                     | merge 毎         | QA           |
| nfr-mnt-006 | 障害対応で外部支援なく解決できた割合を集計      | 月次運用レビュー | SRE          |
| nfr-mnt-007 | API バージョンの後方互換テストを CI で実行      | merge 毎         | QA           |

### 8.5. 関連ドキュメント導線（例）

| 種別     | ドキュメントID | 目的                            | 備考 |
| -------- | -------------- | ------------------------------- | ---- |
| NFR 入口 | nfr-index      | 非機能要件全体の俯瞰            | 必須 |
| 受入条件 | sac-\*         | 保守性要件の合否判定基準        | 必須 |
| 運用設計 | opd-\*         | 監視・アラート・ログ運用設計    | 必須 |
| 運用手順 | opr-\*         | Runbook・障害対応・ロールバック | 必須 |
| 判断記録 | adr-\*         | 保守性に関する設計判断の追跡    | 任意 |

## 9. 生成 AI への指示テンプレート

生成 AI に `nfr-maintainability` を作成させるときの指示テンプレートは [`nfr-maintainability-instruction.md`](../instructions/nfr-maintainability-instruction.md) を参照してください。
