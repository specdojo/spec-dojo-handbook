---
id: meta-test-document-scope-rules
type: meta
title: テストドキュメントスコープ定義ルール
status: draft
---

## 1. 目的

本ルールは、テストに関する各ドキュメント（戦略・観点/条件・テストカタログ等）について、

- **どのドキュメントに**
- **どこまで記述するか**
- **何を書いてはいけないか**

を明確にし、**重複・抜け漏れ・責務の混乱を防ぐ**ことを目的とする。

## 2. 基本原則

### 2.1. 責務分離の原則

- 上位は **方針・基準・責務境界・分配**
- 下位は **対象別の具体化（観点→ケース）、証跡への接続**

とする。

### 2.2. 非重複（SSOT）の原則

- **同一内容を複数成果物に重複記載しない**
- 重複が必要に見える場合は、原則として **参照（IDリンク）で表現**する
- 一次情報（SSOT）の置き場を固定する：
  - 全体方針/品質ゲート：**TSP**
  - ケース（観点×条件の最小表）と証跡リンク：**各レベルの対象別カタログ（`*c-<term>`）**
  - 実行結果：**CI成果物/レポート/ログ**（Evidence）

### 2.3. 「書かない」ことも仕様である

- 対象外・除外理由・委譲先（どのレベルで担保するか）を明示する
- 「ここには書かない」を明示することで、下流工程の迷いを減らす

### 2.4. ドキュメント最小化の原則（カタログ方式）

- テストレベル別ドキュメントは **「概要（index）」＋「対象別（term）」の2種を基本** とする
  - `*c-index`：共通ルール（SSOT）
  - `*c-<term>`：対象別カタログ（SSOT）
- 具体値・詳細手順・網羅展開は、原則として **テストコード／実行結果（CI成果物）** に寄せる
- 監査・外部調整・完全手動などで文書が必要な場合のみ、対象別に **最小チェックリスト** を追記してよい

## 3. ドキュメント体系と責務

本プロジェクトのテストドキュメントは、次の体系で構成する。

- テスト戦略・方針：`tsp-index`
- テストレベル別カタログ：
  - 単体：`utc-index`, `utc-<term>`
  - 内部結合：`itc-index`, `itc-<term>`
  - 外部結合：`etc-index`, `etc-<term>`
  - 総合：`stc-index`, `stc-<term>`
  - 受入：`atc-index`, `atc-<term>`

注：

> - `<term>` は対象単位を表す識別子（用語集GLの論理名キー、kebab-case）とする。
> - 各レベルの `*c-index` は **当該レベルの共通ルールのSSOT**、`*c-<term>` は **当該レベルの対象別ケースSSOT** とする。

### 3.1. 記述内容とドキュメントの対応

| 分類       | 記述内容                                                    | ドキュメント    | ドキュメントID |
| ---------- | ----------------------------------------------------------- | --------------- | -------------- |
| 全体       | テスト全体の目的・基本方針                                  | TSP             | `tsp-index`    |
| 全体       | テストレベル別の責務境界（何をどこで担保するか）            | TSP             | `tsp-index`    |
| 全体       | 品質ゲート（入口条件・出口条件）                            | TSP             | `tsp-index`    |
| 全体       | テスト運用前提（環境/データ/自動化/不具合運用の方針レベル） | TSP             | `tsp-index`    |
| 全体       | 観点/条件設計の共通原則（定義粒度・分類・判定軸）           | TSP             | `tsp-index`    |
| レベル共通 | 当該レベルの対象単位の切り方/分割基準                       | カタログ概要    | `*c-index`     |
| レベル共通 | 当該レベルの対象外・除外理由（共通）                        | カタログ概要    | `*c-index`     |
| レベル共通 | 当該レベルの観点/条件の立て方（共通）                       | カタログ概要    | `*c-index`     |
| レベル共通 | 当該レベルの観点/条件の採用基準・分配方針                   | カタログ概要    | `*c-index`     |
| レベル共通 | 当該レベルの境界/依存の扱い（共通）                         | カタログ概要    | `*c-index`     |
| レベル共通 | ケース表の共通カラム/ID規則                                 | カタログ概要    | `*c-index`     |
| 対象別     | 対象の概要・責務・対象外（対象固有）                        | 対象別カタログ  | `*c-<term>`    |
| 対象別     | 境界/依存（対象固有、例外があれば根拠付き）                 | 対象別カタログ  | `*c-<term>`    |
| 対象別     | トレース（trace_keyの一次情報）                             | 対象別カタログ  | `*c-<term>`    |
| 対象別     | 観点→ケース表（観点×条件=ケース、証跡リンク）               | 対象別カタログ  | `*c-<term>`    |
| 実行/証跡  | 全ケース実装・実行結果・ログ・レポート                      | コード/CI成果物 | （文書IDなし） |

※ 手動実施/監査/外部調整が必要な場合は、`*c-<term>` に **最小限の手順・観測点チェックリスト** を追加で記載してよい（別文書を増やさない）。

### 3.2. テスト戦略・方針（TSP: `tsp-index`）

- テスト全体の目的／基本方針／役割分担（レベル別の責務境界）を定義する
- 品質ゲート（入口条件・出口条件）を定義する
- 観点/条件を設計する際の共通原則（定義粒度・分類・判定軸）を定義する
- 環境・データ・自動化・不具合運用など、テスト運用の前提を定義する
  ※ 個別の観点・条件・ケース・具体値は記載しない

### 3.4. テストカタログ概要（`*c-index`）

- 当該テストレベルの **共通ルール（SSOT）** を定義する
  - 対象単位の切り方（分割基準）
  - 対象外・除外理由（共通）
  - 観点の立て方（共通）
  - 条件の立て方（共通）
  - 観点/条件の採用基準と対象別への分配方針（共通）
  - 境界/依存の扱い（共通）
  - ケース表の共通カラム・ID規則
- `tsp-index` の方針を根拠として、当該レベルの「やる/やらない」を固定する

**禁止事項**

- 個別対象のケースを大量に列挙する（個別は `*c-<term>`）
- 他レベル/他対象の観点・条件表を再掲する（参照に留める）
- 実行手順や具体値を詳細に書く（証跡はCI/コードへ）

### 3.5. テストカタログ対象別（`*c-<term>`）

対象単位ごとに、以下を最小限で定義する（当該レベルのSSOT本体）

- 概要（対象の説明、粒度）
- 責務（このレベルで保証すること）
- 対象外（理由・代替レベル）
- 境界/依存（扱い、例外があれば根拠付き）
- トレース（trace_keyの一次情報）
- テスト観点とケース（観点→ケース表、証跡リンク）

**禁止事項**

- `*c-index` の共通方針を対象ごとに無根拠に上書きする
- 具体値・網羅展開・詳細手順を逐語列挙する（自動はコードへ）
- 根拠のない網羅主張（`tsp-index` / `*c-index` の根拠 + 証跡リンクで示す）

**補足**

- 自動テスト：具体値・詳細手順・データセットは **コード**（parameterized/table-driven等）で表現
- 手動テスト：必要最小限のチェックリスト/観測点のみ追記可

### 3.6. テストレベル別 責務一覧（カタログ対応）

| テストレベル       | 対象（何を確認）                         | 境界（どこまで含める）                       | 重点（落とし穴）                        | 成果物（ID）              |
| ------------------ | ---------------------------------------- | -------------------------------------------- | --------------------------------------- | ------------------------- |
| **単体（UT）**     | モジュール/関数/ロジックの決定的検証     | DB・外部I/F・時刻等は原則隔離                | 境界値/例外/状態分岐/ルール整合         | `utc-index`, `utc-<term>` |
| **内部結合（IT）** | コンポーネント間連携（内部I/F）          | 内部は実接続を増やす、外部は隔離しやすい形で | データ受け渡し/I/F整合/連携例外         | `itc-index`, `itc-<term>` |
| **外部結合（ET）** | 外部I/F（API/ファイル/メッセージ）の成立 | 契約/疎通/失敗系（タイムアウト等）の再現     | 契約差分、認証、冪等性、再送/リトライ   | `etc-index`, `etc-<term>` |
| **総合（ST）**     | 主要業務フローの成立（横断の整合）       | 結合済み構成（内部/外部を含む前提）          | E2E成立、主要例外、データ整合、運用成立 | `stc-index`, `stc-<term>` |
| **受入（AT）**     | 受入条件（SAC/BAC等）の合否              | 実装詳細は見ない（利用者判断粒度）           | 合否判定の明確さ、証跡、業務/運用観点   | `atc-index`, `atc-<term>` |

## 4. 判断に迷ったときのルール（最新版）

1. **「全体方針・品質ゲート・役割分担の話か？」**
   - Yes → **TSP（`tsp-index`）**
   - No → 次へ

2. **「レベル共通の切り方・共通方針・共通カラム/IDの話か？」**
   - Yes → **`*c-index`**
   - No → 次へ

3. **「対象別の責務・境界/依存・トレース・ケース表・証跡リンクの話か？」**
   - Yes → **`*c-<term>`**
   - No → 次へ

4. **「具体値・詳細手順・網羅展開・実行結果か？」**
   - 自動 → **テストコード + CI成果物**
   - 手動 → **`*c-<term>` に最小チェックリスト**（必要最小限）

## 5. よくあるアンチパターン（カタログ版）

| アンチパターン                                           | 問題点                         |
| -------------------------------------------------------- | ------------------------------ |
| `tsp-index` に対象別の具体値・手順・ケースが書かれている | SSOT肥大化／責務逸脱           |
| `*c-index` に個別ケースが大量に載っている                | 役割逆転（共通SSOTが破綻）     |
| 同じケース表が複数ドキュメントに存在する                 | 更新漏れの温床                 |
| 期待値が「正常に動く」など曖昧                           | 合否判定不能／証跡にならない   |
| `case_id` や `trace_key` が頻繁に変更される              | 参照崩壊／履歴追跡不能         |
| 手順をクリック列挙で書き続ける                           | 保守不能／意図不明／変更に弱い |
