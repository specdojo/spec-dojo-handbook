---
id: nfr-availability-rules
title: 非機能要件 / 可用性 作成ルール
type: rulebook
status: draft
---

Non-Functional Requirements Availability Documentation Rules

本ドキュメントは、非機能要件のうち可用性（利用可能性・停止許容・復旧目標）を定義する `nfr-availability` の作成ルールを定義する。
可用性要件は、業務継続に必要な稼働率と復旧目標を定量で記述する。

## 1. 全体方針

- 可用性は稼働率、許容停止時間、RTO/RPO で定義する。
- 対象時間帯と除外条件（計画メンテ等）を必ず明記する。
- 監視・復旧判断と結びつく形で要件化する。

## 2. 位置づけと用語定義（必要に応じて）

### 2.1. 位置づけ

- `nfr-availability`：可用性要求の正本
- `nfr-index`：NFR全体の入口
- `sac-*` / `sts-*`：可用性要件の検証先
- `opd-*` / `opr-*`：障害対応・復旧手順

### 2.2. 用語定義

| 用語   | 定義                                   |
| ------ | -------------------------------------- |
| 稼働率 | 対象時間内でサービス提供可能だった割合 |
| RTO    | 目標復旧時間                           |
| RPO    | 目標復旧時点                           |

## 3. ファイル命名・ID規則

- ルールドキュメントIDは `nfr-availability-rules`。
- 生成対象ドキュメントIDは `nfr-availability` を推奨する。
- 要件IDは `nfr-avl-<連番>` を推奨する。

## 4. 推奨 Frontmatter 項目

### 4.1. 設定内容

Frontmatter は共通スキーマに従います（参照: [shared/schemas/spec-frontmatter.schema.yaml](../../../../shared/schemas/spec-frontmatter.schema.yaml) / [meta-document-metadata-rules.md](meta-document-metadata-rules.md)）。

| 項目    | 説明                                | 必須 |
| ------- | ----------------------------------- | ---- |
| id      | `nfr-availability`                  | ○    |
| type    | `architecture` など共通スキーマ準拠 | ○    |
| title   | 非機能要件: 可用性                  | ○    |
| status  | `draft` / `ready` / `deprecated`    | ○    |
| part_of | `nfr-index`                         | 任意 |

### 4.2. 推奨ルール

- 重要業務時間帯（営業時間、締め時刻）を `based_on` と本文で整合させる。

## 5. 本文構成（標準テンプレ）

`nfr-availability` は以下の見出し構成を **順序固定** で配置する。

| 番号 | 見出し               | 必須 |
| ---- | -------------------- | ---- |
| 1    | 概要（対象・目的）   | ○    |
| 2    | 適用範囲・除外条件   | ○    |
| 3    | 可用性要件一覧       | ○    |
| 4    | 測定・検証方法       | ○    |
| 5    | 関連ドキュメント導線 | ○    |

## 6. 記述ガイド

### 6.1. 概要（対象・目的）

生成する本文の見出しは **## 1. 概要（対象・目的）**

- 可用性管理の目的と対象業務を記述する。

### 6.2. 適用範囲・除外条件

生成する本文の見出しは **## 2. 適用範囲・除外条件**

- 対象時間帯、計画停止、外部依存停止時の扱いを明記する。

### 6.3. 可用性要件一覧

生成する本文の見出しは **## 3. 可用性要件一覧**

- 表形式（`id` / `内容` / `指標` / `基準` / `備考`）で記述する。
- 指標例：月間稼働率、RTO、RPO。

### 6.4. 測定・検証方法

生成する本文の見出しは **## 4. 測定・検証方法**

- 監視値、障害訓練、復旧試験の判定方法を定義する。

### 6.5. 関連ドキュメント導線

生成する本文の見出しは **## 5. 関連ドキュメント導線**

- `opd-*`、`opr-*`、`sac-*`、`adr-*` を紐づける。

## 7. 禁止事項

| 禁止事項                       | 理由                   |
| ------------------------------ | ---------------------- |
| 稼働率の対象時間を示さない     | 指標比較ができないため |
| RTO/RPOを定義しない            | 復旧判断ができないため |
| 「可能な限り復旧」など曖昧表現 | 検証不能のため         |

## 8. サンプル

注：以下はルール文書内の例示です。生成する `nfr-availability` では `## 1...` から始まります。

```yaml
---
id: nfr-availability
type: architecture
title: 非機能要件: 可用性
status: draft
part_of: [nfr-index]
based_on: []
supersedes: []
---
```

### 8.1. 概要（対象・目的）（例）

本書は、GCS 基幹システムにおいて可用性（サービス継続・復旧目標）に関する
非機能要件を定義する。
業務継続に必要な稼働率と障害時の復旧目標を定量化し、SLA および障害対応の
判断基準として運用する。

### 8.2. 適用範囲・除外条件（例）

| 項目         | 内容                                             |
| ------------ | ------------------------------------------------ |
| 対象システム | GCS 基幹システム（受注・在庫・会計サブシステム） |
| 対象時間帯   | 24 時間 365 日                                   |
| 計画停止除外 | 月次メンテナンス（第2日曜 02:00–06:00）          |
| 外部依存除外 | 決済 PSP 障害・物流 API 障害                     |
| 測定開始時点 | 本番リリース後の初回稼働月から                   |

### 8.3. 可用性要件一覧（例）

| id          | 内容                                      | 指標       | 基準           | 備考                       |
| ----------- | ----------------------------------------- | ---------- | -------------- | -------------------------- |
| nfr-avl-001 | 基幹 API は月間稼働率を維持する           | 月間稼働率 | 99.9% 以上     | 計画停止除外               |
| nfr-avl-002 | P1 障害時は目標時間内に復旧する           | RTO        | 60 分以内      | OPR 手順で検証             |
| nfr-avl-003 | P1 障害時のデータ損失を目標範囲内に収める | RPO        | 5 分以内       | WAL + レプリケーション     |
| nfr-avl-004 | P2 障害時は目標時間内に復旧する           | RTO        | 4 時間以内     | 営業時間内対応             |
| nfr-avl-005 | 単一ノード障害でサービスを継続できること  | 冗長構成   | Active-Standby | フェイルオーバー 30 秒以内 |
| nfr-avl-006 | バッチ処理の計画時間超過を防止する        | 完了率     | 99% 以上       | 日次バッチ対象             |
| nfr-avl-007 | DR サイト切替は基準時間内に完了すること   | DR-RTO     | 4 時間以内     | 年次 DR 訓練で検証         |

### 8.4. 測定・検証方法（例）

| 要件ID      | 測定方法                                       | 判定タイミング      | 判定者      |
| ----------- | ---------------------------------------------- | ------------------- | ----------- |
| nfr-avl-001 | 外形監視（HTTP ヘルスチェック 1 分間隔）で算出 | 月次運用レビュー    | SRE         |
| nfr-avl-002 | インシデント記録の復旧完了時刻から算出         | 障害事後レビュー    | SRE / PM    |
| nfr-avl-003 | バックアップ復元試験でデータ差分を確認         | 四半期復元試験      | DBA / SRE   |
| nfr-avl-004 | インシデント記録の復旧完了時刻から算出         | 障害事後レビュー    | SRE         |
| nfr-avl-005 | フェイルオーバー試験で切替時間を計測           | リリース前 / 四半期 | Infra / SRE |
| nfr-avl-006 | バッチジョブ監視ダッシュボードで完了率を集計   | 日次確認            | Ops         |
| nfr-avl-007 | 年次 DR 訓練の実測値                           | 年次 DR 訓練        | SRE / PM    |

### 8.5. 関連ドキュメント導線（例）

| 種別         | ドキュメントID | 目的                         | 備考 |
| ------------ | -------------- | ---------------------------- | ---- |
| NFR 入口     | nfr-index      | 非機能要件全体の俯瞰         | 必須 |
| 受入条件     | sac-\*         | 可用性要件の合否判定基準     | 必須 |
| システム試験 | sts-\*         | フェイルオーバー・DR 試験    | 必須 |
| 運用設計     | opd-\*         | 監視・アラート・復旧判断基準 | 必須 |
| 運用手順     | opr-\*         | 障害一次対応・DR 切替手順    | 必須 |
| 判断記録     | adr-\*         | 冗長構成・DR 方式の設計判断  | 任意 |

## 9. 生成 AI への指示テンプレート

生成 AI に `nfr-availability` を作成させるときの指示テンプレートは [`nfr-availability-instruction.md`](../instructions/nfr-availability-instruction.md) を参照してください。
