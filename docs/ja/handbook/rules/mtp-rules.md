---
id: mtp-rules
title: 移行テスト計画 作成ルール
type: rulebook
status: draft
---

Migration Test Plan (MTP) Documentation Rules

本ドキュメントは、移行テスト計画（リハーサル計画）ドキュメント（`mtp-<term>`）を統一形式で記述するためのルールです。
移行手順と結果の妥当性を事前に検証し、当日の失敗確率を下げるための内容を定義します。

## 1. 全体方針

`mtp-<term>` は、移行リハーサルの計画と評価基準を **再現可能** な形で整理し、GO/NO-GO判断の根拠を提供する。

- リハーサル回数とスケジュールを明確にする
- テスト環境/データ準備を事前に固定する
- 検証観点（件数/差分/業務シナリオ）と合否基準を明記する
- 差異発生時の扱い（許容/修正/再実行）を明文化する
- 結果報告フォーマットとGO/NO-GO判断プロセスを定義する

## 2. 位置づけと用語定義（必要に応じて）

`mtp-<term>` と他ドキュメントの関係を示します。必要に応じて Mermaid を使用してよい。

## 3. ファイル命名・ID規則

- `id` は `mtp-<term>`（kebab-case。例: `mtp-cutover-rehearsal`）。
- ファイル名は `mtp-010-移行テスト計画-<term>.md` 等、プロジェクト内で一意になるように命名する。
- `<term>` は用語集(GL)の論理名キー（英小文字kebab-case）を用いる（表示名は title / ファイル名で日本語を使用してよい）。

## 4. 推奨 Frontmatter 項目

### 4.1. 設定内容

Frontmatter は共通スキーマに従います（参照: [docs/shared/schemas/spec-frontmatter.schema.yaml](../../../shared/schemas/spec-frontmatter.schema.yaml) / [meta-document-metadata-rules.md](meta-document-metadata-rules.md)）。

| 項目       | 説明                                         | 必須 |
| ---------- | -------------------------------------------- | ---- |
| id         | MTP ID（個別: `mtp-<term>`）                 | ○    |
| type       | `migration` 固定                             | ○    |
| title      | 移行テスト計画: <対象名>                     | ○    |
| status     | `draft` / `ready` / `deprecated`             | ○    |
| based_on   | 根拠となる仕様ID（ID配列。未指定は `[]` 可） | 任意 |
| supersedes | 置き換え関係（ID配列。未指定は `[]` 可）     | 任意 |

### 4.2. 推奨ルール

- `based_on` には移行判断に直接利用した成果物（例: `br-*` / `nfr-*` / `issue-*`）のみ列挙する
- `based_on` / `supersedes` は ID 配列（未指定は `[]` 可）

## 5. 本文構成（標準テンプレ）

`mtp-<term>` は以下の見出し構成を **順序固定** で配置します。

| 番号 | 見出し                               | 必須 |
| ---- | ------------------------------------ | ---- |
| 1    | 概要（`<term>`）                     | ○    |
| 2    | リハーサル回数とスケジュール         | ○    |
| 3    | テスト環境/データ準備                | ○    |
| 4    | 検証観点（件数/差分/業務シナリオ）   | ○    |
| 5    | 合否基準                             | ○    |
| 6    | 差異発生時の扱い（許容/修正/再実行） | ○    |
| 7    | 結果報告フォーマット                 | ○    |
| 8    | GO/NO-GO判断プロセス                 | ○    |

## 6. 記述ガイド

### 6.1. 概要（`<term>`）

生成する `mtp-<term>` 本文の見出しは **## 1. 概要（`<term>`）**

- 何のリハーサルを、どの目的で行うかを 1〜3 行で示す
- `mip-overview` と整合すること

### 6.2. リハーサル回数とスケジュール

生成する `mtp-<term>` 本文の見出しは **## 2. リハーサル回数とスケジュール**

- 実施回数、実施日程、実施目的を明記する

推奨フォーマット（表）:

| 回数 | 予定日 | 目的 | 完了条件 |
| ---- | ------ | ---- | -------- |

### 6.3. テスト環境/データ準備

生成する `mtp-<term>` 本文の見出しは **## 3. テスト環境/データ準備**

- 環境（staging/検証環境等）と前提設定を明記する
- データ準備（データセットID、初期化/後始末）を明記する

### 6.4. 検証観点（件数/差分/業務シナリオ）

生成する `mtp-<term>` 本文の見出しは **## 4. 検証観点（件数/差分/業務シナリオ）**

- 件数照合、差分検知、業務シナリオ検証の観点を整理する

推奨フォーマット（表）:

| 観点 | 方法 | 期待値 |
| ---- | ---- | ------ |

### 6.5. 合否基準

生成する `mtp-<term>` 本文の見出しは **## 5. 合否基準**

- 合格基準、許容誤差、判断者を明記する

推奨フォーマット（表）:

| 項目 | 基準 | 判定者 |
| ---- | ---- | ------ |

### 6.6. 差異発生時の扱い（許容/修正/再実行）

生成する `mtp-<term>` 本文の見出しは **## 6. 差異発生時の扱い（許容/修正/再実行）**

- 許容できる差異、修正が必要な差異、再実行条件を明記する

### 6.7. 結果報告フォーマット

生成する `mtp-<term>` 本文の見出しは **## 7. 結果報告フォーマット**

- 報告に必要な項目（日時/結果/差異/証跡）を明記する

推奨フォーマット（表）:

| 項目 | 記載内容 |
| ---- | -------- |

### 6.8. GO/NO-GO判断プロセス

生成する `mtp-<term>` 本文の見出しは **## 8. GO/NO-GO判断プロセス**

- 判断プロセス、判断主体、必要な証跡を明記する

## 7. 禁止事項

| 禁止事項                        | 理由                           |
| ------------------------------- | ------------------------------ |
| リハーサル回数/日程を曖昧に書く | 実行計画が不明確になるため     |
| 合否基準を曖昧にする            | GO/NO-GO判断ができないため     |
| 差異発生時の扱いを未定義にする  | 再実行判断がぶれるため         |
| 結果報告フォーマットを省略する  | 合意形成と追跡が困難になるため |

## 8. サンプル（最小）

注：以下はルール文書内の例示です。生成する `mtp-<term>` では `## 1...` から始まります。

```yaml
---
id: mtp-cutover-rehearsal
type: migration
title: 移行テスト計画: カットオーバーリハーサル
status: draft
based_on: []
supersedes: []
---
```

### 8.1. 概要（cutover-rehearsal）

本番切替のリハーサルを実施し、手順と結果の妥当性を確認する。

### 8.2. リハーサル回数とスケジュール

| 回数 | 予定日     | 目的               | 完了条件          |
| ---- | ---------- | ------------------ | ----------------- |
| 1    | 2026-03-01 | 手順の実行確認     | 全工程完了        |
| 2    | 2026-03-15 | 差異検知と再現確認 | 差異0または許容内 |

### 8.3. テスト環境/データ準備

- 環境: staging
- データ: 受注データセット `DS-ORDER-01`

### 8.4. 検証観点（件数/差分/業務シナリオ）

| 観点     | 方法          | 期待値 |
| -------- | ------------- | ------ |
| 件数照合 | 旧/新件数比較 | 差分0  |
| 業務検証 | 代表シナリオ  | 成功   |

### 8.5. 合否基準

| 項目     | 基準 | 判定者     |
| -------- | ---- | ---------- |
| 件数差異 | 0    | 業務責任者 |
| 重大障害 | 0    | PO         |

### 8.6. 差異発生時の扱い（許容/修正/再実行）

- 差異が閾値超の場合は原因修正後に再実行する

### 8.7. 結果報告フォーマット

| 項目 | 記載内容            |
| ---- | ------------------- |
| 日時 | 実施日/開始終了時刻 |
| 結果 | 合格/不合格         |
| 差異 | 差分件数と理由      |
| 証跡 | ログ/レポート参照先 |

### 8.8. GO/NO-GO判断プロセス

- 判定者: 移行責任者
- 証跡: レポート/ログ/差分一覧

## 9. 生成 AI への指示テンプレート

生成 AI に `mtp-<term>` を作らせるときの指示テンプレートは `mtp-instruction.md` を参照してください。
