---
id: otp-rules
title: 運用切替計画 作成ルール
type: rulebook
status: draft
---

Operations Transition Plan (OTP) Documentation Rules

本ドキュメントは、運用切替計画（ハイパーケア含む）ドキュメント（`otp-index` / `otp-<term>`）を統一形式で記述するためのルールです。
切替後の運用を途切れさせず、初期不具合・問合せ増に耐える体制を作るための内容を定義します。

## 1. 全体方針

`otp-index`（必要に応じて `otp-<term>`）は、切替後の運用安定化と初期対応体制の SSOT とする。

- 監視/アラート、バックアップ/リストアなどの運用基盤を明記する
- 権限/アカウント移行と運用手順の変更点を整理する
- 問合せ窓口と一次対応体制、障害対応フローを明確にする
- ハイパーケア期間の増員体制（期間/当番/SLA）を定義する
- 旧システムの停止/参照方針とクローズ条件を明記する

運用方針（index/term 分割）:

- 原則 `otp-index` を作成し、運用切替計画の入口（SSOT）とする
- `otp-<term>` は、対象が複数（領域/拠点/システム群/運用ドメイン）に分かれる、または監視・窓口・当番が独立している場合に追加する
- `otp-<term>` を追加する場合でも、共通方針（期間・SLA・優先度分類・クローズ基準など）は `otp-index` を正とする
- **「関連ドキュメント」セクションは必須**（分冊が無い場合でも `（本書のみ）` を明記して空欄にしない）

## 2. 位置づけ

`otp-index` / `otp-<term>` と他ドキュメントの関係を示します。必要に応じて Mermaid による図を使用してよい。

- `mip-index`：移行の合意・判断のSSOT（成功条件・カットオーバー骨格を含む）
- `dmd-index` / `dmd-<term>`：データ移行の詳細設計（マッピング/変換/検証）
- `mtp-index` / `mtp-<term>`：リハーサル計画・検証設計（観点/手順/証跡）
- `cop-index` / `cop-<term>`：当日実行の詳細手順（Runbook）
- **`otp-index` / `otp-<term>`：運用切替の詳細（監視設定/運用手順/窓口）**

## 3. ファイル命名・ID規則

- `id` は `otp-index` または `otp-<term>`（kebab-case。例: `otp-hypercare` / `otp-support-desk`）。
- ファイル名は `otp-010-運用切替計画.md` / `otp-020-運用切替計画-<term>.md` 等、プロジェクト内で一意になるように命名する。
- `<term>` は用語集(GL)の論理名キー（英小文字kebab-case）を用いる（表示名は title / ファイル名で日本語を使用してよい）。

## 4. 推奨 Frontmatter 項目

### 4.1. 設定内容

Frontmatter は共通スキーマに従います（参照: [docs/shared/schemas/spec-frontmatter.schema.yaml](../../../shared/schemas/spec-frontmatter.schema.yaml) / [meta-document-metadata-rules.md](meta-document-metadata-rules.md)）。

| 項目       | 説明                                         | 必須 |
| ---------- | -------------------------------------------- | ---- |
| id         | OTP ID（`otp-index` または `otp-<term>`）    | ○    |
| type       | `migration` 固定                             | ○    |
| title      | 運用切替計画: <対象名>                       | ○    |
| status     | `draft` / `ready` / `deprecated`             | ○    |
| based_on   | 根拠となる仕様ID（ID配列。未指定は `[]` 可） | 任意 |
| supersedes | 置き換え関係（ID配列。未指定は `[]` 可）     | 任意 |

### 4.2. 推奨ルール

- `based_on` には運用・移行判断に直接利用した成果物（例: `mip-index` / `cop-index` / `mtp-index` / `br-*` / `issue-*`）のみ列挙する
- `based_on` / `supersedes` は ID 配列（未指定は `[]` 可）

## 5. 本文構成（標準テンプレ）

`otp-index` / `otp-<term>` は以下の見出し構成を **順序固定** で配置します。

| 番号 | 見出し                          | 必須 |
| ---- | ------------------------------- | ---- |
| 1    | 概要（`index` / `<term>`）      | ○    |
| 2    | 監視/アラート                   | ○    |
| 3    | バックアップ/リストア           | ○    |
| 4    | 権限/アカウント移行             | ○    |
| 5    | 運用手順の変更点                | ○    |
| 6    | 問合せ窓口/一次対応             | ○    |
| 7    | 障害対応フロー                  | ○    |
| 8    | 初期増員体制（期間・当番・SLA） | ○    |
| 9    | 旧システムの停止/参照方針       | ○    |
| 10   | 移行完了後のクローズ条件        | ○    |
| 11   | 関連ドキュメント                | ○    |

補足:

- `otp-index` は「共通方針（期間/SLA/優先度分類/クローズ基準/入口）」を持ち、分冊がある場合は導線を持つ
- `otp-<term>` は term固有（監視対象、窓口、当番、手順差分）に寄せる
- 「関連ドキュメント」セクションは **必須**（分冊が無い場合も `（本書のみ）` と明記）

## 6. 記述ガイド

### 6.1. 概要（`index` / `<term>`）

生成する本文の見出しは **## 1. 概要（`index` / `<term>`）**

- 切替後の運用安定化の目的と適用範囲を 1〜3 行で示す
- `mip-index` のハイパーケア方針と整合させる
- `otp-<term>` の場合は対象範囲（どの運用領域/チーム/サービスが対象か）を明記する

### 6.2. 監視/アラート

生成する本文の見出しは **## 2. 監視/アラート**

- 監視対象、指標/閾値、通知先を明記する
- 重大アラートの初動ルール（一次応答期限、エスカレーション条件）を明記する

推奨フォーマット（表）:

| 監視対象 | 指標/閾値 | 通知先 | 初動ルール | 備考 |
| -------- | --------- | ------ | ---------- | ---- |

### 6.3. バックアップ/リストア

生成する本文の見出しは **## 3. バックアップ/リストア**

- バックアップ頻度、保管先、保持期間を明記する
- リストア時の責任者、実施手順（リンク可）、完了基準（整合性確認）を明記する
- 可能なら「復旧目標（RTO/RPO）」を方針として記載してよい

### 6.4. 権限/アカウント移行

生成する本文の見出しは **## 4. 権限/アカウント移行**

- 旧/新の権限差分、移行タイミング、切替当日の扱いを明記する
- 移行後のアクセス検証方法（主要ロールのログイン/操作）を明記する
- 緊急時の権限付与（ブレークグラス）方針がある場合は記載する

### 6.5. 運用手順の変更点

生成する本文の見出しは **## 5. 運用手順の変更点**

- 旧手順との差分を一覧で示す
- 変更理由と影響（誰の何が変わるか）を明記する
- 具体的手順書はリンクでよい（本文に詳細手順を長大に貼らない）

推奨フォーマット（表）:

| 手順 | 旧  | 新  | 変更理由 | 影響 | 参照 |
| ---- | --- | --- | -------- | ---- | ---- |

### 6.6. 問合せ窓口/一次対応

生成する本文の見出しは **## 6. 問合せ窓口/一次対応**

- 問合せ窓口、受付時間、一次対応範囲を明記する
- 受付チャネル（メール/フォーム/チャット/電話）と優先度分類（P1〜等）を明記する
- エスカレーション条件（一次で止めない条件）を明記する

### 6.7. 障害対応フロー

生成する本文の見出しは **## 7. 障害対応フロー**

- 障害発生時の判断/連絡/復旧/報告の流れを明記する
- エスカレーション先と判断基準（重大度、影響範囲、復旧見込み）を明記する
- 重大障害時の指揮系統（インシデントコマンダー等）があれば明記する

### 6.8. 初期増員体制（期間・当番・SLA）

生成する本文の見出しは **## 8. 初期増員体制（期間・当番・SLA）**

- ハイパーケア期間、当番体制、SLA（一次応答/暫定復旧など）を明記する
- 期間終了の判断者と条件を明記する（クローズ条件と整合）
- 役割分担（運用/開発/業務）を最小限で示す

推奨フォーマット（表）:

| 期間 | 体制（当番/時間帯） | SLA目安 | 判断者 | 備考 |
| ---- | ------------------- | ------- | ------ | ---- |

### 6.9. 旧システムの停止/参照方針

生成する本文の見出しは **## 9. 旧システムの停止/参照方針**

- 停止時期、参照可否、データ保持/アーカイブ方針を明記する
- 停止後の問い合わせ対応（どこで何を見られるか）を明記する

### 6.10. 移行完了後のクローズ条件

生成する本文の見出しは **## 10. 移行完了後のクローズ条件**

- 完了条件（重大障害未発生期間、問い合わせ収束、運用手順整備完了等）を列挙する
- クローズ判断者と最終報告物（振り返り/運用引継ぎ/残課題）を明記する

### 6.11. 関連ドキュメント（必須）

生成する本文の見出しは **## 11. 関連ドキュメント**

- `otp-index` の場合：各 `otp-<term>` への導線を必ず記載する
- `otp-<term>` の場合：`otp-index` への導線（本体SSOT）を必ず記載する
- 分冊が無い場合でも `（本書のみ）` を明記する

推奨フォーマット（箇条書き）:

- `<doc-id>`：<説明>
- `<doc-id>`：<説明>

## 7. 禁止事項

| 禁止事項                                                      | 理由                               |
| ------------------------------------------------------------- | ---------------------------------- |
| 監視/アラートの通知先や閾値が未記載                           | 初動が遅れ、障害影響が拡大するため |
| ハイパーケア体制（期間/当番/SLA）を省略する                   | 初期増加負荷に耐えられないため     |
| 旧システム停止/参照方針が不明確                               | 利用者・運用の混乱を招くため       |
| クローズ条件を未記載にする                                    | 収束判定ができないため             |
| `otp-<term>` に共通方針を重複記載し、`otp-index` と矛盾させる | SSOTが崩れ、参照が割れるため       |
| 「関連ドキュメント」セクションを省略する                      | 導線が失われ、参照先が分散するため |

## 8. サンプル（最小・整合版）

注：以下はルール文書内の例示です。生成する `otp-index` / `otp-<term>` では `## 1...` から始まります。

### 8.1. `otp-index`（全体SSOT・入口）

```yaml
---
id: otp-index
type: migration
title: 運用切替計画: 全体
status: draft
based_on:
  - mip-index
  - cop-index
supersedes: []
---
```

#### 8.1.1. 概要（index）

切替後の運用安定化、問い合わせ一次対応、ハイパーケア体制、旧システム停止/参照方針、クローズ条件を定義する。
本書は運用切替計画のSSOTであり、領域別に分割する場合は `otp-<term>` に詳細を分離する。

#### 8.1.2. 監視/アラート

| 監視対象 | 指標/閾値 | 通知先 | 初動ルール           | 備考    |
| -------- | --------- | ------ | -------------------- | ------- |
| API      | 5xx > 1%  | #ops   | P1は30分以内一次応答 | 5分平均 |

#### 8.1.3. バックアップ/リストア

- バックアップ: 夜間フル、日中は差分（保持 30 日）
- 保管先: オブジェクトストレージ（権限は運用のみ）
- リストア: 運用責任者が開始判断し、作業ログと復旧確認（主要シナリオ/整合性照合）を残す

#### 8.1.4. 権限/アカウント移行

- 移行タイミング: 切替前日 20:00
- 検証: 主要ロールでログイン/代表操作を確認（証跡は検証ログ）

#### 8.1.5. 運用手順の変更点

| 手順     | 旧   | 新       | 変更理由 | 影響         | 参照             |
| -------- | ---- | -------- | -------- | ------------ | ---------------- |
| 障害連絡 | 電話 | チャット | 初動短縮 | 連絡経路変更 | （手順書リンク） |

#### 8.1.6. 問合せ窓口/一次対応

- 受付: #support（09:00-18:00）
- 優先度: P1（業務停止）/P2（影響大）/P3（軽微）
- 一次対応範囲: FAQ・既知不具合の案内、切り分け、エスカレーション起票

#### 8.1.7. 障害対応フロー

- エスカレーション: 一次対応 → 運用責任者 → PO
- 判断基準: 重大障害（P1）/影響拡大/復旧見込み不明

#### 8.1.8. 初期増員体制（期間・当番・SLA）

| 期間        | 体制（当番/時間帯）                               | SLA目安             | 判断者     | 備考                         |
| ----------- | ------------------------------------------------- | ------------------- | ---------- | ---------------------------- |
| 切替後2週間 | Ops 2名 + Biz 1名（8:00-20:00）/ 夜間はオンコール | P1:30分以内一次連絡 | 運用責任者 | 期間延長はクローズ条件で判断 |

#### 8.1.9. 旧システムの停止/参照方針

- 停止: 切替後 7 日でログイン停止
- 参照: 90 日間は参照専用、その後アーカイブ
- 停止後の問い合わせ: 参照手順と窓口を本書に従う

#### 8.1.10. 移行完了後のクローズ条件

- 重大障害 0 件が 30 日継続
- 問合せが日次平均 5 件以下
- 運用手順差分が確定し、引継ぎが完了

#### 8.1.11. 関連ドキュメント

- `otp-hypercare`：ハイパーケア詳細（当番/窓口/運用手順の実運用版）
- `cop-index`：切替当日の実行手順（連携・前提）
- `mip-index`：移行計画（成功条件/ハイパーケア方針）
- （必要に応じて）`mtp-index`：移行リハーサル計画（運用観点の検証）

---

### 8.2. `otp-<term>`（個別：例）

```yaml
---
id: otp-hypercare
type: migration
title: 運用切替計画: ハイパーケア
status: draft
based_on:
  - otp-index
  - mip-index
supersedes: []
---
```

#### 8.2.1. 概要（hypercare）

切替後の初期不具合・問い合わせ増に対応するため、ハイパーケア体制（増員・SLA・運用手順）を具体化する。
共通方針は `otp-index` を正とし、本書はハイパーケアの運用詳細に限定する。

#### 8.2.2. 監視/アラート

| 監視対象 | 指標/閾値 | 通知先 | 初動ルール           | 備考    |
| -------- | --------- | ------ | -------------------- | ------- |
| API      | 5xx > 1%  | #ops   | P1は30分以内一次応答 | 5分平均 |
| バッチ   | 失敗=1回  | #ops   | 影響範囲を即共有     | 日次    |

#### 8.2.3. バックアップ/リストア

- 方式: 夜間フル + 日中差分（保持30日）
- リストア責任者: 運用責任者
- 完了基準: 主要業務のスモーク成功 + 整合性照合レポートOK

#### 8.2.4. 権限/アカウント移行

- 追加権限: ハイパーケア担当に限定付与（期間終了で剥奪）
- 検証: 当番ロールで監視/ログ参照/障害対応が可能であること

#### 8.2.5. 運用手順の変更点

| 手順       | 旧     | 新       | 変更理由    | 影響         | 参照               |
| ---------- | ------ | -------- | ----------- | ------------ | ------------------ |
| 問合せ受付 | メール | #support | 集約/可視化 | チャネル統一 | （運用手順リンク） |

#### 8.2.6. 問合せ窓口/一次対応

- 受付: #support / 09:00-18:00（期間中は延長運用あり）
- 一次対応: 既知不具合案内、ログ採取依頼、再現条件ヒアリング
- エスカレーション: P1は即時 #ops と #po に共有

#### 8.2.7. 障害対応フロー

- 指揮: 運用責任者（必要に応じてPO）
- 連絡: #ops → #po → 利用者告知（#comms）

#### 8.2.8. 初期増員体制（期間・当番・SLA）

| 期間        | 体制（当番/時間帯）                             | SLA目安                | 判断者     | 備考                     |
| ----------- | ----------------------------------------------- | ---------------------- | ---------- | ------------------------ |
| 切替後2週間 | 8:00-20:00は常駐（Ops2 + Biz1）/ 夜間オンコール | P1:30分一次連絡、P2:2h | 運用責任者 | 延長はクローズ条件で判断 |

#### 8.2.9. 旧システムの停止/参照方針

- 参照依頼は一次窓口で受付し、参照手順に従い対応する
- 参照期間終了後は「アーカイブ照会手順」に切替える（リンク）

#### 8.2.10. 移行完了後のクローズ条件

- P1=0が30日、P2が収束傾向、問い合わせが基準以下
- 既知不具合一覧がクローズ/運用引継ぎ完了

#### 8.2.11. 関連ドキュメント

- `otp-index`：運用切替計画のSSOT（共通方針/期間/SLA/クローズ基準）
- `mip-index`：移行計画（ハイパーケア方針）
- `cop-index`：切替当日の計画（前提・影響）
- （必要に応じて）`mtp-index`：リハーサル計画（運用観点の検証）

## 9. 生成 AI への指示テンプレート

生成 AI に `otp-index` / `otp-<term>` を作らせるときの指示テンプレートは `otp-instruction.md` を参照してください。
