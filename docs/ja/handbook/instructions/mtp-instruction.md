# 移行テスト計画 作成の指示テンプレート

以下のルールに従って、**移行テスト計画（`mtp-index` / `mtp-<term>`）** を 1 ファイル作成してください。出力は **Markdown** とします。

- `mtp-index` は移行テスト計画の入口（全体SSOT）です。
- `mtp-<term>` は必要時のみ作成し、term固有の内容に限定してください。
- リハーサル計画と評価基準を再現可能な形で整理し、GO/NO-GO判断の根拠を明確にしてください。

## 事前に与えられる情報（入力）

次の情報が与えられている前提で、それに整合する `mtp-index` または `mtp-<term>` を生成してください（不明な場合は「未確定」として明記してよい）。

- リハーサルの対象範囲（全体/term）と目的
- リハーサル回数、実施日程、完了条件
- テスト環境、データセット、初期化/後始末条件
- 検証観点（件数照合/差分検知/業務シナリオ）
- 合否基準（停止許容、差分許容、重大障害の扱い）
- 差異発生時の扱い（許容/修正/再実行）
- 結果報告フォーマット（日時/結果/差異/証跡）
- GO/NO-GO 判断主体と判断プロセス
- 関連ドキュメント（`mip-index` / `dmd-*` / `cop-*` / `otp-*` など）

## 出力フォーマット（必須）

### YAML Frontmatter（必須）

先頭に YAML Frontmatter を付与し、以下の形式で記述してください（`id` / `type` / `title` / `status` は必須、`type` は `migration` 固定）。

#### `mtp-index` を作る場合

```yaml
---
id: mtp-index
type: migration
title: 移行テスト計画: 全体
status: draft # draft / ready / deprecated
based_on: []
supersedes: []
---
```

#### `mtp-<term>` を作る場合

```yaml
---
id: mtp-<term>
type: migration
title: 移行テスト計画: <対象名>
status: draft # draft / ready / deprecated
based_on: []
supersedes: []
---
```

- `based_on` には移行判断に直接利用した成果物のみを列挙してください（例: `mip-index` / `dmd-*` / `issue-*`）。

### 本文の見出し（必須・順序固定）

本文は次の見出し（日本語）をこの順序で必ず含めてください。

1. 概要（`index` / `<term>`）
2. リハーサル回数とスケジュール
3. テスト環境/データ準備
4. 検証観点（件数/差分/業務シナリオ）
5. 合否基準
6. 差異発生時の扱い（許容/修正/再実行）
7. 結果報告フォーマット
8. GO/NO-GO判断プロセス
9. 関連ドキュメント

## 記述ルール（重要）

### スコープ（書く / 書かない）

- 書く: 計画・検証・判断に必要な最小情報（回数、日程、基準、判断主体、証跡）
- 書かない: 実装コード、長大SQL、分単位Runbookの詳細（必要なら `cop-*` を参照）

### SSOTと分冊ルール

- `mtp-index` は全体方針・全体日程・GO/NO-GO基準の正とする。
- `mtp-<term>` は term固有の差分に寄せ、共通方針を重複記載しない。
- `mtp-<term>` の全体判断は `mtp-index` に従う。

### 合否判断可能性

- 曖昧表現（例: 「問題ない」「概ね成功」）は禁止し、合否判定できる条件で記述する。
- 合否基準、差異時対応、判断主体、判断入力（証跡）を必ず明記する。

## 各セクションの書き方

### 1. 概要（`index` / `<term>`）

- 何のリハーサルを何の目的で行うかを 1〜3 行で示す。
- `mip-index` と整合させる。
- `mtp-<term>` では term固有の範囲（含む/含まない）を明記する。

### 2. リハーサル回数とスケジュール

- 実施回数、予定日、実施目的、完了条件を明記する。
- `mtp-<term>` では全体日程との関係（ウェーブ順/前提）を明記する。

推奨フォーマット（表）:

| 回数 | 予定日 | 目的 | 完了条件 |
| ---- | ------ | ---- | -------- |

### 3. テスト環境/データ準備

- 環境（staging/検証環境など）と前提設定を明記する。
- データ準備（データセットID、初期化/後始末）を明記する。
- 可能なら責任者と手順参照先（runbook）を明記する。

### 4. 検証観点（件数/差分/業務シナリオ）

- 件数照合、差分検知、業務シナリオ検証を整理する。
- `dmd-*` の検証定義（件数/重要値/許容差）と整合させる。

推奨フォーマット（表）:

| 観点 | 方法 | 期待値 |
| ---- | ---- | ------ |

### 5. 合否基準

- 合格基準、許容誤差、判定者を明記する。
- 停止許容/差分許容/重大障害の観点を最低限含める。

推奨フォーマット（表）:

| 項目 | 基準 | 判定者 |
| ---- | ---- | ------ |

### 6. 差異発生時の扱い（許容/修正/再実行）

- 許容差異、要修正差異、再実行条件を明記する。
- 再実行の上限（回数/期限）と判断者を可能な限り明記する。

### 7. 結果報告フォーマット

- 報告必須項目（日時/結果/差異/証跡）を明記する。
- 報告先（チケット/共有フォルダ/リポジトリ）を可能な限り明記する。

推奨フォーマット（表）:

| 項目 | 記載内容 |
| ---- | -------- |

### 8. GO/NO-GO判断プロセス

- 判断プロセス、判断主体、必要な証跡を明記する。
- `mtp-index` は全体の判断を定義する。
- `mtp-<term>` はterm固有判定点がある場合のみ追記し、全体判断は `mtp-index` に従う。

### 9. 関連ドキュメント

- `mtp-index` の場合：各 `mtp-<term>` への導線を必ず記載する。
- `mtp-<term>` の場合：`mtp-index` への導線を必ず記載する。
- 分冊が無い場合でも `（なし）` または `（本書のみ）` を明記し、空欄にしない。

推奨フォーマット（箇条書き）:

- `<doc-id>`：<説明>
- `<doc-id>`：<説明>

## 最終チェック（自己検査）

- `id` が `mtp-index` または `mtp-<term>` である
- `type: migration` / `status` が設定されている
- 見出しが指定順序で揃っている（欠落なし）
- リハーサル回数・日程・完了条件が明記されている
- 合否基準と差異発生時の扱い（許容/修正/再実行）が明記されている
- GO/NO-GO 判断主体と判断入力（証跡）が明記されている
- `関連ドキュメント` が空欄でない（`（なし）` / `（本書のみ）` でも可）
- `mtp-<term>` の場合、`mtp-index` への導線が記載されている
