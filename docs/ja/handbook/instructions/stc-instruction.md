# 総合テストカタログ 対象別 作成の指示テンプレート

以下のルールに従って、**総合テストカタログ-対象別（`stc-<term>`）** を 1 ファイル作成してください。出力は **Markdown** とします。

- `stc-<term>` は **対象固有の情報のみ**を記述し、共通ルールは `stc-overview` を参照します（重複記述しない）。
- 総合テストの目的は「**実運用に近い経路で、システム全体として業務が成立すること**」の確認です。
- ケースは「表の1行＝1テスト（1シナリオ）」とし、手順と期待値は **判定可能**な粒度で簡潔に書きます。
- クリック列挙や画面要素の細部説明は避け、手順は **高位の行動** と **観測点** に寄せます（詳細はテストコードへ）。
- 環境・テストデータ・外部依存（sandbox/スタブ等）は **再現性** を優先し、対象ごとに無根拠に変更しません（例外は根拠を明記）。

## 事前に与えられる情報（入力）

次の情報が与えられている前提で、それに整合する `stc-<term>` を生成してください（不明な場合は「未確定」として明記してよい）。

- 対象システム/プロダクトの概要
- 上位方針: `tsp-overview`
- `stc-overview`（共通方針）
- 対象 `term` の目的、境界、主要I/F（画面、API、バッチ、イベント等）
- 参照すべき上位仕様（`br-*` / `bac-*` / `spec-*` / `nfr-*` / `ac-*` / `issue-*` 等）
- 環境前提（staging、外部I/Fのsandbox/スタブ方針）
- テストコード/CI/レポート での証跡参照先（ログ相関キー等）

## 出力フォーマット（必須）

### YAML Frontmatter（必須）

先頭に YAML Frontmatter を付与し、以下の形式で記述してください（`id` / `type` / `title` / `status` は必須、`type` は `test` 固定）。

```yaml
---
id: stc-<term>
type: test
title: 総合テストカタログ: <対象名>
status: draft # draft / ready / deprecated
part_of: []
based_on:
 - tsp-overview
 - stc-overview
supersedes: []
---
```

- `based_on` には **最低限** `tsp-overview` と `stc-overview` を含めてください。
- 対象固有の根拠（`br-*` / `bac-*` / `spec-*` / `nfr-*` / `ac-*` / `issue-*` 等）は、本文の **トレース表** に集約します。

### 本文の見出し（必須・順序固定）

本文は次の見出し（日本語）をこの順序で必ず含めてください。

1. 概要（`<term>`）
2. 目的
3. 対象外
4. 境界/環境/依存
5. トレース
6. テスト観点とケース

## 記述ルール（重要）

### スコープ（書く / 書かない）

- 書く: 対象固有の目的・境界・環境前提、観点×条件＝ケース、トレース、証跡
- 書かない: `stc-overview` にある共通方針の再掲、細かい操作列挙、個別の詳細手順

### 追跡可能性（トレース）

- 本ドキュメントの **トレース表が一次情報（SSOT）** です。
- 観点/ケース表では **仕様IDを直書きせず** `TR-xx` のみ参照します。

### ケース/具体値の扱い

- ケース表の 1 行は 1 テスト（1シナリオ）とします。
- 具体値や詳細手順は最小限に抑え、必要な詳細はテストコードに委譲します。

## 各セクションの書き方

### 1. 概要（`<term>`）

- 対象が何であり、どの業務シナリオ/経路を本カタログで扱うかを 1〜3 行で書く。
- `stc-overview` の分割基準に従い、過分割／肥大化を避ける。

### 2. 目的

- 「この総合テスト対象で何を保証したいか」を **動詞で始まる箇条書き** で 3〜7 個程度示す。
- 可能なら観測可能な成果（画面表示、API応答、DB状態、イベント、ログ相関ID等）とセットで書く。

### 3. 対象外

- 対象外は理由と代替レベルを併記する（例: 「xxx（理由: yyy、代替: ET）」）。
- `stc-overview` の対象外と矛盾しない。

### 4. 境界/環境/依存

- 境界（開始トリガ/入口、完了条件/出口）を明記する。
- 環境前提（staging、テストデータ準備・後始末）を明記する。
- 外部依存の扱い（sandbox/スタブ/疑似応答）を決める。
- 観測点（Evidence）を明記する。

### 5. トレース

- 仕様IDに対応する **トレース表** を作成する。
- 各行に `trace_key`（`TR-01` 形式）を付与し、観点/ケース表では `TR-xx` のみ参照する。

### 6. テスト観点とケース

- 観点（見出し）→ 意図 → 条件・ケース表の順で構成する。
- `case_id` は `<level>-<term>-<perspective_key>-<nnn>` を推奨し変更しない（`level` は `st`）。
- `条件` は `入力:` `状態:` `環境:` `経路:` の要点で表現する（必要な要素のみ記載）。
- `手順（最小）` は **高位の最小手順** に留め、クリック列挙は禁止する。
- `期待値` は判定可能に書く（画面/レスポンスに加え、DB状態、イベント、監査ログ、相関ID等の観測点を含める）。

## ケース表の共通カラム（必須）

`stc-overview` の定義に従い、以下のカラムを **順序固定** で使用します。

- **必須カラム**: `case_id` / `条件` / `手順（最小）` / `期待値`
- **推奨カラム**: `観測点（アサーション）` / `環境/依存` / `トレース` / `優先度` / `自動化` / `証跡`

## 最終チェック（自己検査）

- `id: stc-<term>` / `type: test` / `status` が設定されている
- `based_on` に `tsp-overview` と `stc-overview` が入っている
- 見出しが指定順序で揃っている（欠落なし）
- トレース表が SSOT になっている（`TR-xx` 参照で統一）
- ケース表のカラムが `stc-overview` と一致している
