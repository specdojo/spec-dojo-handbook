# 運用方針・設計 作成の指示テンプレート

以下のルールに従って、**運用方針・設計（`opd-index` / `opd-<term>`）** を 1 ファイル作成してください。出力は **Markdown** とします。

- `opd-index` は恒常運用の方針・統制の入口（全体SSOT）です。
- `opd-<term>` は必要時のみ作成し、`opd-index` の差分（補足・具体化・例外）に限定してください。
- OPD は「方針と統制（あるべき姿・判断基準）」を定義し、手順詳細は OPR に委譲してください。

## 事前に与えられる情報（入力）

次の情報が与えられている前提で、それに整合する `opd-index` または `opd-<term>` を生成してください（不明な場合は「未確定」として明記してよい）。

- 運用対象範囲と前提（対象システム/業務/時間帯/制約）
- SLO・SLA・KPI（目標値、測定期間、測定方法、判定者）
- 体制・責任分界（RACI、当番、エスカレーション）
- 監視・アラート方針（指標/閾値/通知先/初動）
- 障害対応方針（優先度、停止判断、周知）
- 変更管理方針（承認、実施条件、ロールバック条件）
- バックアップ・リストア方針（RTO/RPO）
- 権限・アカウント運用（棚卸し、監査ログ、緊急権限）
- 定期運用方針（バッチ、点検）
- 問い合わせ運用方針（窓口、分類、一次対応SLA）
- 関連ドキュメント導線（`opr-index` / `opr-<term>`、必要時のみ `mip-*` / `mtp-*` / `cop-*` / `otp-*`）

## 出力フォーマット（必須）

### YAML Frontmatter（必須）

先頭に YAML Frontmatter を付与し、以下の形式で記述してください（`id` / `type` / `title` / `status` は必須、`type` は `operations` 固定）。

#### `opd-index` を作る場合

```yaml
---
id: opd-index
type: operations
title: 運用方針・設計: 全体
status: draft # draft / ready / deprecated
based_on: []
supersedes: []
---
```

#### `opd-<term>` を作る場合

```yaml
---
id: opd-<term>
type: operations
title: 運用方針・設計: <対象名>
status: draft # draft / ready / deprecated
based_on: []
supersedes: []
---
```

- `based_on` には恒常運用設計判断に直接利用した成果物のみを列挙してください（例: `nfr-*` / `sac-*` / `br-*` / `issue-*`）。
- OPR は参照してよいが、`based_on` には運用判断の根拠のみを載せ、手順書は導線で扱ってください。

### 本文の見出し（必須・順序固定）

本文は次の見出し（日本語）をこの順序で必ず含めてください。

1. 概要（`index` / `<term>`）
2. 運用の範囲・前提
3. SLO・SLA・KPI
4. 体制・責任分界（RACI・当番・エスカレーション）
5. 監視・アラート方針（指標・閾値・通知先・初動）
6. 障害対応方針（優先度・停止判断・周知）
7. 変更管理（リリース・設定変更・承認・ロールバック）
8. バックアップ・リストア方針（RTO/RPO）
9. 権限・アカウント運用（棚卸し・監査ログ）
10. 定期運用方針（バッチ・点検）
11. 問い合わせ運用方針（窓口・分類・SLA）
12. 関連ドキュメント導線（`opr` 等）

## 記述ルール（重要）

### スコープ（書く / 書かない）

- 書く: 方針・統制・判断基準（SLO/SLA/KPI、RACI、変更管理、RTO/RPOなど）
- 書かない: 実行コマンドやチェックリストなどの手順詳細（OPRへ委譲）

### SSOTと分冊ルール

- `opd-index` は恒常運用の共通統制の正とする。
- `opd-<term>` は `opd-index` の差分（補足・具体化・例外）に限定し、全体方針の重複を避ける。

### 判定可能性

- 曖昧表現（例: 「適切」「問題ない」）は禁止し、定量または判定条件で記述する。
- 判定者、測定方法、証跡を必ず明記する。

## 各セクションの書き方

### 1. 概要（`index` / `<term>`）

- 何を運用方針として定義するかを 1〜3 行で示す。
- `opd-index` が恒常運用のSSOTであることを明記する。
- `opd-<term>` では `opd-index` の差分・補足であることを1行で示す。

### 2. 運用の範囲・前提

- 対象システム/業務/時間帯、非対象範囲を明記する。
- 法令/契約/セキュリティ/組織体制などの前提制約を明記する。

### 3. SLO・SLA・KPI

- 可用性、応答時間、一次応答などの目標を定量で定義する。
- 測定期間、測定方法、証跡、判定者を明記する。

推奨フォーマット（表）:

| 指標 | 目標値 | 測定期間 | 測定方法 | 証跡 | 判定者 |
| ---- | ------ | -------- | -------- | ---- | ------ |

### 4. 体制・責任分界（RACI・当番・エスカレーション）

- RACI、当番体制、連絡系統を明記する。
- 優先度別のエスカレーション条件（いつ・誰が・どこへ）を明記する。

推奨フォーマット（表）:

| 対象 | R   | A   | C   | I   | 備考 |
| ---- | --- | --- | --- | --- | ---- |

### 5. 監視・アラート方針（指標・閾値・通知先・初動）

- 監視対象、閾値、通知先、初動ルールを明記する。
- 誤検知/検知漏れ対策の方針を必要に応じて記載する。

推奨フォーマット（表）:

| 監視対象 | 指標/閾値 | 通知先 | 初動（誰が何をするか） | 備考 |
| -------- | --------- | ------ | ---------------------- | ---- |

### 6. 障害対応方針（優先度・停止判断・周知）

- 優先度分類（P1/P2/P3等）と停止判断条件を明記する。
- 周知対象・手段・タイミングを明記する。

推奨フォーマット（表）:

| 優先度 | 例  | 目標（一次応答/復旧） | 停止判断 | 周知 |
| ------ | --- | --------------------- | -------- | ---- |

### 7. 変更管理（リリース・設定変更・承認・ロールバック）

- 変更種別、承認フロー、実施条件（時間帯/凍結期間等）を明記する。
- ロールバック条件と承認者を明記する。

### 8. バックアップ・リストア方針（RTO/RPO）

- バックアップ方式、保管先、保持期間を明記する。
- RTO/RPO と復旧手順参照先を明記する（詳細手順は OPR へ委譲）。

### 9. 権限・アカウント運用（棚卸し・監査ログ）

- 権限付与/剥奪ルール、棚卸し周期、監査ログ方針を明記する。
- 緊急権限（ブレークグラス）の管理条件を明記する。

### 10. 定期運用方針（バッチ・点検）

- 定期バッチ、定期点検、実施責任者、証跡を明記する。
- 未実施時のエスカレーション方針を明記する。

### 11. 問い合わせ運用方針（窓口・分類・SLA）

- 受付窓口、分類ルール、一次対応SLAを明記する。
- 連携先（開発/業務/運用）への引き継ぎ条件を明記する。

### 12. 関連ドキュメント導線（`opr` 等）

- `opr-index` への導線を必ず記載する。
- `opr-<term>` がある場合は該当手順への導線を併記する。
- 分冊がない場合でも `（本書のみ）` または `（なし）` を明記する。
- `mip-*` / `mtp-*` / `cop-*` / `otp-*` は必要時のみ参考情報として記載する。

推奨フォーマット（表）:

| 種別 | ドキュメントID | 目的 | 備考 |
| ---- | -------------- | ---- | ---- |

## 最終チェック（自己検査）

- `id` が `opd-index` または `opd-<term>` である
- `type: operations` / `status` が設定されている
- 見出しが指定順序で揃っている（欠落なし）
- SLO/SLA/KPI が定量で定義され、測定方法・証跡・判定者がある
- RACI/当番/エスカレーションと変更管理条件がある
- バックアップ方針に RTO/RPO 観点がある
- `関連ドキュメント導線` に `opr-index` が含まれている
- `opd-<term>` の場合、`opd-index` との差分であることが明記されている
