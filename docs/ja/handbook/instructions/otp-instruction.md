# 運用切替計画 作成の指示テンプレート

以下のルールに従って、**運用切替計画（`otp-index` / `otp-<term>`）** を 1 ファイル作成してください。出力は **Markdown** とします。

- `otp-index` は運用切替計画の入口（全体SSOT）です。
- `otp-<term>` は必要時のみ作成し、term固有の運用詳細に限定してください。
- 切替後の運用を途切れさせず、初期不具合・問合せ増に耐える体制を明確にしてください。

## 事前に与えられる情報（入力）

次の情報が与えられている前提で、それに整合する `otp-index` または `otp-<term>` を生成してください（不明な場合は「未確定」として明記してよい）。

- 対象範囲（全体/term）と運用安定化の目的
- 監視/アラート（対象、指標/閾値、通知先、初動ルール）
- バックアップ/リストア（頻度、保管先、保持期間、責任者）
- 権限/アカウント移行（差分、移行タイミング、検証方法）
- 運用手順の変更点（旧→新、理由、影響、参照）
- 問合せ窓口/一次対応（受付時間、チャネル、優先度分類）
- 障害対応フロー（判断/連絡/復旧/報告、エスカレーション）
- 初期増員体制（期間、当番、SLA、終了判断者）
- 旧システムの停止/参照方針
- 移行完了後のクローズ条件と最終報告物
- 関連ドキュメント（`mip-index` / `cop-index` / `mtp-index` / `dmd-*` / `otp-*`）

## 出力フォーマット（必須）

### YAML Frontmatter（必須）

先頭に YAML Frontmatter を付与し、以下の形式で記述してください（`id` / `type` / `title` / `status` は必須、`type` は `migration` 固定）。

#### `otp-index` を作る場合

```yaml
---
id: otp-index
type: migration
title: 運用切替計画: 全体
status: draft # draft / ready / deprecated
based_on: []
supersedes: []
---
```

#### `otp-<term>` を作る場合

```yaml
---
id: otp-<term>
type: migration
title: 運用切替計画: <対象名>
status: draft # draft / ready / deprecated
based_on: []
supersedes: []
---
```

- `based_on` には運用・移行判断に直接利用した成果物のみを列挙してください（例: `mip-index` / `cop-index` / `mtp-index` / `br-*` / `issue-*`）。

### 本文の見出し（必須・順序固定）

本文は次の見出し（日本語）をこの順序で必ず含めてください。

1. 概要（`index` / `<term>`）
2. 監視/アラート
3. バックアップ/リストア
4. 権限/アカウント移行
5. 運用手順の変更点
6. 問合せ窓口/一次対応
7. 障害対応フロー
8. 初期増員体制（期間・当番・SLA）
9. 旧システムの停止/参照方針
10. 移行完了後のクローズ条件
11. 関連ドキュメント

## 記述ルール（重要）

### スコープ（書く / 書かない）

- 書く: 運用安定化に必要な最小情報（監視、窓口、当番、SLA、停止/参照、クローズ条件）
- 書かない: 実装コード、長大手順、下位手順書に置くべき詳細（必要なら参照リンク）

### SSOTと分冊ルール

- `otp-index` は共通方針（期間/SLA/優先度分類/クローズ基準）の正とする。
- `otp-<term>` は term固有（監視対象、窓口、当番、手順差分）に寄せる。
- `otp-<term>` は `otp-index` と矛盾しない。

### 実行可能性と判定可能性

- 曖昧表現（例: 「適宜対応」）は禁止し、判断条件と責任者を明確にする。
- 監視閾値、一次応答目安、エスカレーション条件、クローズ条件を明記する。

## 各セクションの書き方

### 1. 概要（`index` / `<term>`）

- 切替後の運用安定化の目的と適用範囲を 1〜3 行で示す。
- `mip-index` のハイパーケア方針と整合させる。
- `otp-<term>` では対象範囲（運用領域/チーム/サービス）を明記する。

### 2. 監視/アラート

- 監視対象、指標/閾値、通知先を明記する。
- 重大アラートの初動ルール（一次応答期限、エスカレーション条件）を明記する。

推奨フォーマット（表）:

| 監視対象 | 指標/閾値 | 通知先 | 初動ルール | 備考 |
| -------- | --------- | ------ | ---------- | ---- |

### 3. バックアップ/リストア

- バックアップ頻度、保管先、保持期間を明記する。
- リストア責任者、手順参照先（リンク可）、完了基準（整合性確認）を明記する。
- 可能なら復旧目標（RTO/RPO）を方針として記載する。

### 4. 権限/アカウント移行

- 旧/新の権限差分、移行タイミング、切替当日の扱いを明記する。
- 移行後アクセス検証（主要ロールのログイン/操作）を明記する。
- 緊急時権限付与（ブレークグラス）方針があれば記載する。

### 5. 運用手順の変更点

- 旧手順との差分を一覧で示す。
- 変更理由と影響（誰の何が変わるか）を明記する。
- 詳細手順書はリンクでよい（本文に長大手順を貼らない）。

推奨フォーマット（表）:

| 手順 | 旧  | 新  | 変更理由 | 影響 | 参照 |
| ---- | --- | --- | -------- | ---- | ---- |

### 6. 問合せ窓口/一次対応

- 問合せ窓口、受付時間、一次対応範囲を明記する。
- 受付チャネル（メール/フォーム/チャット/電話）と優先度分類（P1〜等）を明記する。
- エスカレーション条件（一次で止めない条件）を明記する。

### 7. 障害対応フロー

- 障害発生時の判断/連絡/復旧/報告の流れを明記する。
- エスカレーション先と判断基準（重大度、影響範囲、復旧見込み）を明記する。
- 重大障害時の指揮系統があれば明記する。

### 8. 初期増員体制（期間・当番・SLA）

- ハイパーケア期間、当番体制、SLA（一次応答/暫定復旧など）を明記する。
- 期間終了の判断者と条件を明記する（クローズ条件と整合）。
- 役割分担（運用/開発/業務）を最小限で示す。

推奨フォーマット（表）:

| 期間 | 体制（当番/時間帯） | SLA目安 | 判断者 | 備考 |
| ---- | ------------------- | ------- | ------ | ---- |

### 9. 旧システムの停止/参照方針

- 停止時期、参照可否、データ保持/アーカイブ方針を明記する。
- 停止後の問い合わせ対応（どこで何を見られるか）を明記する。

### 10. 移行完了後のクローズ条件

- 完了条件（重大障害未発生期間、問い合わせ収束、手順整備完了等）を列挙する。
- クローズ判断者と最終報告物（振り返り/運用引継ぎ/残課題）を明記する。

### 11. 関連ドキュメント

- `otp-index` の場合：各 `otp-<term>` への導線を必ず記載する。
- `otp-<term>` の場合：`otp-index` への導線（本体SSOT）を必ず記載する。
- 分冊が無い場合でも `（本書のみ）` を明記し、空欄にしない。

推奨フォーマット（箇条書き）:

- `<doc-id>`：<説明>
- `<doc-id>`：<説明>

## 最終チェック（自己検査）

- `id` が `otp-index` または `otp-<term>` である
- `type: migration` / `status` が設定されている
- 見出しが指定順序で揃っている（欠落なし）
- 監視/アラートに指標/閾値・通知先・初動ルールがある
- 初期増員体制に期間・当番・SLA・終了判断者がある
- 旧システム停止/参照方針とクローズ条件がある
- 問合せ窓口/一次対応と障害対応フローがある
- `関連ドキュメント` が空欄でない（`（本書のみ）` でも可）
- `otp-<term>` の場合、`otp-index` への導線が記載されている
